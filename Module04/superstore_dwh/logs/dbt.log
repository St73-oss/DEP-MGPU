[0m12:21:59.597687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc1db57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc0d68220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc0d681c0>]}


============================== 12:21:59.600233 | f8a0f34c-a91f-4232-8486-77c892168e2d ==============================
[0m12:21:59.600233 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:21:59.600926 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/dev/.dbt'}
[0m12:21:59.782078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8a0f34c-a91f-4232-8486-77c892168e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc382d3f0>]}
[0m12:21:59.843185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8a0f34c-a91f-4232-8486-77c892168e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc0c44250>]}
[0m12:21:59.844120 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:21:59.955673 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:21:59.956448 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:21:59.957078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8a0f34c-a91f-4232-8486-77c892168e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc09b40a0>]}
[0m12:22:01.090630 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.superstore_dwh.stg_orders' (models/staging/stg_orders.sql) depends on a source named 'stg.orders' which was not found
[0m12:22:01.091757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5490327, "process_in_blocks": "72", "process_kernel_time": 0.110463, "process_mem_max_rss": "112348", "process_out_blocks": "8", "process_user_time": 2.496884}
[0m12:22:01.092344 [debug] [MainThread]: Command `dbt run` failed at 12:22:01.092241 after 1.55 seconds
[0m12:22:01.092827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadc1db57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadbf59c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aadbf591f00>]}
[0m12:22:01.093319 [debug] [MainThread]: Flushing usage events
[0m12:22:01.778238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:50.173039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b74b17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b6468cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b6468c70>]}


============================== 12:25:50.175632 | c073e0f0-ea7f-4b1d-9b97-ceab4157feeb ==============================
[0m12:25:50.175632 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:25:50.176295 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '/home/dev/.dbt', 'static_parser': 'True', 'empty': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:25:50.339467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b640fe80>]}
[0m12:25:50.401858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b6ce6bc0>]}
[0m12:25:50.402747 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:25:50.488762 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:25:50.489714 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:25:50.490259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b6371f90>]}
[0m12:25:51.798676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b418da50>]}
[0m12:25:51.893483 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:25:51.895087 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:25:51.916860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b394acb0>]}
[0m12:25:51.917450 [info ] [MainThread]: Found 9 models, 4 data tests, 1 source, 434 macros
[0m12:25:51.917899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b394b310>]}
[0m12:25:51.919706 [info ] [MainThread]: 
[0m12:25:51.920206 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:51.920600 [info ] [MainThread]: 
[0m12:25:51.921176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:25:51.926684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:25:51.935182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:25:51.942861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:25:52.027087 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:25:52.027603 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:25:52.028077 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:25:52.028522 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:25:52.029336 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:25:52.030181 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:25:52.029786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:52.028956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:52.030600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:52.041172 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m12:25:52.043631 [debug] [ThreadPool]: On list_superstore: Close
[0m12:25:52.044269 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m12:25:52.045652 [debug] [ThreadPool]: On list_superstore: Close
[0m12:25:52.046978 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m12:25:52.048238 [debug] [ThreadPool]: On list_superstore: Close
[0m12:25:52.049166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now create_superstore_public_dw_test)
[0m12:25:52.051095 [debug] [ThreadPool]: Creating schema "database: "superstore"
schema: "public_dw_test"
"
[0m12:25:52.051790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now create_superstore_public_stg)
[0m12:25:52.057091 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_dw_test"
[0m12:25:52.057816 [debug] [ThreadPool]: Creating schema "database: "superstore"
schema: "public_stg"
"
[0m12:25:52.058289 [debug] [ThreadPool]: On create_superstore_public_dw_test: BEGIN
[0m12:25:52.060654 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_stg"
[0m12:25:52.061132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:52.061609 [debug] [ThreadPool]: On create_superstore_public_stg: BEGIN
[0m12:25:52.062250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:52.068452 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:25:52.068967 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_dw_test"
[0m12:25:52.069381 [debug] [ThreadPool]: On create_superstore_public_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "create_superstore_public_dw_test"} */
create schema if not exists "public_dw_test"
[0m12:25:52.070133 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m12:25:52.072064 [debug] [ThreadPool]: On create_superstore_public_dw_test: COMMIT
[0m12:25:52.073530 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_dw_test"
[0m12:25:52.074034 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:25:52.074510 [debug] [ThreadPool]: On create_superstore_public_dw_test: COMMIT
[0m12:25:52.074954 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_stg"
[0m12:25:52.075608 [debug] [ThreadPool]: On create_superstore_public_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "create_superstore_public_stg"} */
create schema if not exists "public_stg"
[0m12:25:52.076363 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:25:52.076992 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:25:52.077461 [debug] [ThreadPool]: On create_superstore_public_dw_test: Close
[0m12:25:52.078426 [debug] [ThreadPool]: On create_superstore_public_stg: COMMIT
[0m12:25:52.078986 [debug] [ThreadPool]: Using postgres connection "create_superstore_public_stg"
[0m12:25:52.079399 [debug] [ThreadPool]: On create_superstore_public_stg: COMMIT
[0m12:25:52.080983 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:25:52.081458 [debug] [ThreadPool]: On create_superstore_public_stg: Close
[0m12:25:52.084800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_superstore_public_stg, now list_superstore_public_dw_test)
[0m12:25:52.085410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_superstore_public_dw_test, now list_superstore_public_stg)
[0m12:25:52.091379 [debug] [ThreadPool]: Using postgres connection "list_superstore_public_dw_test"
[0m12:25:52.092144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_public)
[0m12:25:52.094571 [debug] [ThreadPool]: Using postgres connection "list_superstore_public_stg"
[0m12:25:52.095087 [debug] [ThreadPool]: On list_superstore_public_dw_test: BEGIN
[0m12:25:52.097624 [debug] [ThreadPool]: On list_superstore_public_stg: BEGIN
[0m12:25:52.097190 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:25:52.098041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:52.098895 [debug] [ThreadPool]: On list_superstore_public: BEGIN
[0m12:25:52.098461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:52.099459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:52.109359 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:25:52.109833 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:25:52.110263 [debug] [ThreadPool]: Using postgres connection "list_superstore_public_dw_test"
[0m12:25:52.111181 [debug] [ThreadPool]: On list_superstore_public_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_public_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dw_test'
  
[0m12:25:52.110696 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:25:52.111854 [debug] [ThreadPool]: On list_superstore_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_public"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:25:52.113834 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m12:25:52.114362 [debug] [ThreadPool]: Using postgres connection "list_superstore_public_stg"
[0m12:25:52.114749 [debug] [ThreadPool]: On list_superstore_public_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_public_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_stg'
  
[0m12:25:52.142384 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.030 seconds
[0m12:25:52.144147 [debug] [ThreadPool]: On list_superstore_public: ROLLBACK
[0m12:25:52.144588 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.033 seconds
[0m12:25:52.144934 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.030 seconds
[0m12:25:52.146285 [debug] [ThreadPool]: On list_superstore_public_dw_test: ROLLBACK
[0m12:25:52.147408 [debug] [ThreadPool]: On list_superstore_public_stg: ROLLBACK
[0m12:25:52.148145 [debug] [ThreadPool]: On list_superstore_public: Close
[0m12:25:52.148676 [debug] [ThreadPool]: On list_superstore_public_dw_test: Close
[0m12:25:52.150397 [debug] [ThreadPool]: On list_superstore_public_stg: Close
[0m12:25:52.157951 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:52.158472 [debug] [MainThread]: On master: BEGIN
[0m12:25:52.158897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:52.165487 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:25:52.166016 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:52.166420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:25:52.211618 [debug] [MainThread]: SQL status: SELECT 0 in 0.045 seconds
[0m12:25:52.213375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4100700>]}
[0m12:25:52.214128 [debug] [MainThread]: On master: ROLLBACK
[0m12:25:52.215033 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:52.215518 [debug] [MainThread]: On master: BEGIN
[0m12:25:52.216363 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:25:52.216791 [debug] [MainThread]: On master: COMMIT
[0m12:25:52.217167 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:52.217523 [debug] [MainThread]: On master: COMMIT
[0m12:25:52.218131 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:52.218530 [debug] [MainThread]: On master: Close
[0m12:25:52.236988 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m12:25:52.237661 [info ] [Thread-1 (]: 1 of 9 START sql table model public_dw_test.calendar_dim ....................... [RUN]
[0m12:25:52.238218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_public_dw_test, now model.superstore_dwh.calendar_dim)
[0m12:25:52.238780 [debug] [Thread-2 (]: Began running node model.superstore_dwh.my_first_dbt_model
[0m12:25:52.239268 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m12:25:52.239875 [info ] [Thread-2 (]: 2 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m12:25:52.240507 [debug] [Thread-3 (]: Began running node model.superstore_dwh.stg_orders
[0m12:25:52.250373 [info ] [Thread-3 (]: 3 of 9 START sql view model public_stg.stg_orders .............................. [RUN]
[0m12:25:52.251310 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_superstore_public, now model.superstore_dwh.stg_orders)
[0m12:25:52.247809 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m12:25:52.249388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_public_stg, now model.superstore_dwh.my_first_dbt_model)
[0m12:25:52.253279 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.my_first_dbt_model
[0m12:25:52.251783 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.stg_orders
[0m12:25:52.254002 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m12:25:52.258986 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.262837 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m12:25:52.299441 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.stg_orders
[0m12:25:52.322132 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.calendar_dim"
[0m12:25:52.335076 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.my_first_dbt_model
[0m12:25:52.341224 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:25:52.341755 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: BEGIN
[0m12:25:52.342183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:52.340849 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.344272 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.345326 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: BEGIN
[0m12:25:52.344863 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.stg_orders"
[0m12:25:52.347375 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:25:52.346077 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:52.347866 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: BEGIN
[0m12:25:52.351417 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:25:52.363833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m12:25:52.365471 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:25:52.366478 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */

  
    

  create  table "superstore"."public_dw_test"."calendar_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу-календарь
SELECT
    to_char(date,'yyyymmdd')::int as dateid,
    extract('year' from date)::int as year,
    extract('quarter' from date)::int as quarter,
    extract('month' from date)::int as month,
    extract('week' from date)::int as week,
    date::date,
    to_char(date, 'dy') as week_day,
    -- Проверка на високосный год
    CASE
        WHEN extract('day' from (date + interval '2 month - 1 day')) = 29 THEN 'leap'
        ELSE 'not leap'
    END as leap
FROM generate_series(
    date '2010-01-01',
    date '2030-12-31',
    interval '1 day'
) AS t(date)
  );
  
[0m12:25:52.368292 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m12:25:52.368893 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:25:52.369733 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */

  create view "superstore"."public_stg"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
-- Эта модель читает данные из исходной таблицы stg.orders,
-- приводит их к нужным типам и исправляет ошибку с почтовым кодом.
-- Все последующие модели будут ссылаться на эту, а не на исходную таблицу.

SELECT
    -- Приводим все к нижнему регистру для консистентности в dbt
    "order_id",
    ("order_date")::date as order_date,
    ("ship_date")::date as ship_date,
    "ship_mode",
    "customer_id",
    "customer_name",
    "segment",
    "country",
    "city",
    "state",
    -- Исправляем проблему с Burlington прямо здесь, один раз и навсегда
    CASE
        WHEN "city" = 'Burlington' AND "postal_code" IS NULL THEN '05401'
        ELSE "postal_code"
    END as postal_code,
    "region",
    "product_id",
    "category",
    "subcategory" as sub_category, -- переименовываем для соответствия
    "product_name",
    "sales",
    "quantity",
    "discount",
    "profit"
FROM "superstore"."stg"."orders"
  );
[0m12:25:52.370591 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m12:25:52.371769 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.373617 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */

  
    

  create  table "superstore"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:25:52.443236 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.069 seconds
[0m12:25:52.455103 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.456176 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */
alter table "superstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:25:52.457137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:25:52.470993 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: COMMIT
[0m12:25:52.471625 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.472635 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: COMMIT
[0m12:25:52.485996 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m12:25:52.493223 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.122 seconds
[0m12:25:52.496525 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:25:52.497035 [debug] [Thread-2 (]: Applying DROP to: "superstore"."public"."my_first_dbt_model__dbt_backup"
[0m12:25:52.497574 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
alter table "superstore"."public_stg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:25:52.502207 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:25:52.503103 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */
drop table if exists "superstore"."public"."my_first_dbt_model__dbt_backup" cascade
[0m12:25:52.503558 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:52.505597 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m12:25:52.506042 [debug] [Thread-1 (]: SQL status: SELECT 7670 in 0.139 seconds
[0m12:25:52.506424 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m12:25:52.506991 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:25:52.511017 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:25:52.515426 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
alter table "superstore"."public_dw_test"."calendar_dim__dbt_tmp" rename to "calendar_dim"
[0m12:25:52.514913 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m12:25:52.514178 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: Close
[0m12:25:52.517881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4dc0e80>]}
[0m12:25:52.518642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:25:52.519470 [info ] [Thread-2 (]: 2 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.27s]
[0m12:25:52.521686 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m12:25:52.522242 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:25:52.523004 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.my_first_dbt_model
[0m12:25:52.523574 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:25:52.528121 [debug] [Thread-3 (]: Applying DROP to: "superstore"."public_stg"."stg_orders__dbt_backup"
[0m12:25:52.529058 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m12:25:52.532108 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:25:52.533486 [debug] [Thread-4 (]: Began running node model.superstore_dwh.my_second_dbt_model
[0m12:25:52.535036 [info ] [Thread-4 (]: 4 of 9 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m12:25:52.534276 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
drop view if exists "superstore"."public_stg"."stg_orders__dbt_backup" cascade
[0m12:25:52.536198 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.my_second_dbt_model'
[0m12:25:52.536979 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.my_second_dbt_model
[0m12:25:52.537576 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:25:52.540500 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.543642 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.my_second_dbt_model
[0m12:25:52.542948 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: Close
[0m12:25:52.541145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m12:25:52.547775 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.552132 [debug] [Thread-1 (]: Applying DROP to: "superstore"."public_dw_test"."calendar_dim__dbt_backup"
[0m12:25:52.556956 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b39b7b20>]}
[0m12:25:52.557949 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.560509 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: BEGIN
[0m12:25:52.560972 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:25:52.558974 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:25:52.563123 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
drop table if exists "superstore"."public_dw_test"."calendar_dim__dbt_backup" cascade
[0m12:25:52.559754 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public_stg.stg_orders ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m12:25:52.565360 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.stg_orders
[0m12:25:52.567801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:25:52.570351 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: Close
[0m12:25:52.571113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b49fda50>]}
[0m12:25:52.577031 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public_dw_test.calendar_dim .................. [[32mSELECT 7670[0m in 0.33s]
[0m12:25:52.579250 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m12:25:52.580311 [debug] [Thread-2 (]: Began running node model.superstore_dwh.customer_dim
[0m12:25:52.581760 [debug] [Thread-1 (]: Began running node model.superstore_dwh.geo_dim
[0m12:25:52.582228 [debug] [Thread-3 (]: Began running node model.superstore_dwh.product_dim
[0m12:25:52.584282 [info ] [Thread-2 (]: 5 of 9 START sql table model public_dw_test.customer_dim ....................... [RUN]
[0m12:25:52.588801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.my_first_dbt_model, now model.superstore_dwh.customer_dim)
[0m12:25:52.582969 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m12:25:52.590126 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.590680 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */

  create view "superstore"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "superstore"."public"."my_first_dbt_model"
where id = 1
  );
[0m12:25:52.585223 [info ] [Thread-1 (]: 6 of 9 START sql table model public_dw_test.geo_dim ............................ [RUN]
[0m12:25:52.591678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.geo_dim)
[0m12:25:52.589390 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.customer_dim
[0m12:25:52.592194 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.geo_dim
[0m12:25:52.599895 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:25:52.586170 [info ] [Thread-3 (]: 7 of 9 START sql table model public_dw_test.product_dim ........................ [RUN]
[0m12:25:52.611133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.product_dim)
[0m12:25:52.611626 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.product_dim
[0m12:25:52.605881 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m12:25:52.620813 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.geo_dim
[0m12:25:52.610448 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.629272 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */
alter table "superstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:25:52.600636 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m12:25:52.630163 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.customer_dim
[0m12:25:52.627338 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.geo_dim"
[0m12:25:52.641889 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m12:25:52.641245 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.customer_dim"
[0m12:25:52.640013 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m12:25:52.645966 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.product_dim
[0m12:25:52.643612 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: COMMIT
[0m12:25:52.653608 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.654362 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:25:52.654977 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:25:52.656657 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: BEGIN
[0m12:25:52.657075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:52.652234 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.product_dim"
[0m12:25:52.656161 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: BEGIN
[0m12:25:52.655547 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: COMMIT
[0m12:25:52.659266 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:25:52.660893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:52.663028 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: BEGIN
[0m12:25:52.665814 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:25:52.671211 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:25:52.680475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m12:25:52.682125 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:25:52.685715 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */

  
    

  create  table "superstore"."public_dw_test"."geo_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает географический справочник
SELECT
    100 + row_number() OVER (ORDER BY "postal_code", "city", "state") as geo_id,
    "country",
    "city",
    "state",
    "postal_code"
FROM (
    SELECT DISTINCT "country", "city", "state", "postal_code" FROM "superstore"."public_stg"."stg_orders"
) as unique_geo
  );
  
[0m12:25:52.689083 [debug] [Thread-4 (]: Applying DROP to: "superstore"."public"."my_second_dbt_model__dbt_backup"
[0m12:25:52.698061 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:25:52.700736 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */
drop view if exists "superstore"."public"."my_second_dbt_model__dbt_backup" cascade
[0m12:25:52.701789 [debug] [Thread-2 (]: SQL status: BEGIN in 0.041 seconds
[0m12:25:52.702310 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:25:52.702815 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */

  
    

  create  table "superstore"."public_dw_test"."customer_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник клиентов
SELECT
    100 + row_number() OVER (ORDER BY "customer_id") as cust_id,
    "customer_id",
    "customer_name"
FROM (
    SELECT DISTINCT "customer_id", "customer_name" FROM "superstore"."public_stg"."stg_orders"
) as unique_customers
  );
  
[0m12:25:52.704710 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:25:52.706255 [debug] [Thread-4 (]: On model.superstore_dwh.my_second_dbt_model: Close
[0m12:25:52.707079 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.021 seconds
[0m12:25:52.707711 [debug] [Thread-3 (]: SQL status: BEGIN in 0.037 seconds
[0m12:25:52.712681 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:25:52.714122 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */

  
    

  create  table "superstore"."public_dw_test"."product_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник продуктов
SELECT
    100 + row_number() OVER (ORDER BY "product_id") as prod_id,
    "product_id",
    "product_name",
    "category",
    "sub_category",
    "segment"
FROM (
    SELECT DISTINCT "product_id", "product_name", "category", "sub_category", "segment" FROM "superstore"."public_stg"."stg_orders"
) as unique_products
  );
  
[0m12:25:52.713457 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b51fd270>]}
[0m12:25:52.711590 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:25:52.718354 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
alter table "superstore"."public_dw_test"."geo_dim__dbt_tmp" rename to "geo_dim"
[0m12:25:52.716785 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.18s]
[0m12:25:52.720375 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.my_second_dbt_model
[0m12:25:52.721150 [debug] [Thread-4 (]: Began running node model.superstore_dwh.shipping_dim
[0m12:25:52.721742 [info ] [Thread-4 (]: 8 of 9 START sql table model public_dw_test.shipping_dim ....................... [RUN]
[0m12:25:52.724455 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.my_second_dbt_model, now model.superstore_dwh.shipping_dim)
[0m12:25:52.725355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:25:52.730121 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m12:25:52.727243 [debug] [Thread-2 (]: SQL status: SELECT 993 in 0.024 seconds
[0m12:25:52.727823 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m12:25:52.733829 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:25:52.754998 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m12:25:52.743322 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:25:52.756218 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
alter table "superstore"."public_dw_test"."customer_dim__dbt_tmp" rename to "customer_dim"
[0m12:25:52.756836 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m12:25:52.758412 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.shipping_dim
[0m12:25:52.757256 [debug] [Thread-3 (]: SQL status: SELECT 4544 in 0.043 seconds
[0m12:25:52.762620 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.shipping_dim"
[0m12:25:52.763099 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:25:52.767642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m12:25:52.767142 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:25:52.774222 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
alter table "superstore"."public_dw_test"."product_dim__dbt_tmp" rename to "product_dim"
[0m12:25:52.769573 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m12:25:52.775387 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:25:52.775835 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m12:25:52.774793 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:25:52.776394 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: BEGIN
[0m12:25:52.773602 [debug] [Thread-1 (]: Applying DROP to: "superstore"."public_dw_test"."geo_dim__dbt_backup"
[0m12:25:52.776831 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:25:52.777697 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:25:52.778947 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:25:52.781913 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: COMMIT
[0m12:25:52.783211 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:25:52.783736 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: COMMIT
[0m12:25:52.782646 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
drop table if exists "superstore"."public_dw_test"."geo_dim__dbt_backup" cascade
[0m12:25:52.784317 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m12:25:52.787802 [debug] [Thread-2 (]: Applying DROP to: "superstore"."public_dw_test"."customer_dim__dbt_backup"
[0m12:25:52.789765 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:25:52.788258 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:25:52.791725 [debug] [Thread-1 (]: On model.superstore_dwh.geo_dim: Close
[0m12:25:52.788682 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:25:52.790274 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
drop table if exists "superstore"."public_dw_test"."customer_dim__dbt_backup" cascade
[0m12:25:52.798085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4d66aa0>]}
[0m12:25:52.798630 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:25:52.797011 [debug] [Thread-3 (]: Applying DROP to: "superstore"."public_dw_test"."product_dim__dbt_backup"
[0m12:25:52.802819 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:25:52.799437 [info ] [Thread-1 (]: 6 of 9 OK created sql table model public_dw_test.geo_dim ....................... [[32mSELECT 832[0m in 0.21s]
[0m12:25:52.801655 [debug] [Thread-2 (]: On model.superstore_dwh.customer_dim: Close
[0m12:25:52.805372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4d02350>]}
[0m12:25:52.804507 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.geo_dim
[0m12:25:52.803804 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
drop table if exists "superstore"."public_dw_test"."product_dim__dbt_backup" cascade
[0m12:25:52.807224 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:25:52.806234 [info ] [Thread-2 (]: 5 of 9 OK created sql table model public_dw_test.customer_dim .................. [[32mSELECT 993[0m in 0.22s]
[0m12:25:52.803288 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m12:25:52.809142 [debug] [Thread-3 (]: On model.superstore_dwh.product_dim: Close
[0m12:25:52.809860 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.customer_dim
[0m12:25:52.810355 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:25:52.815629 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */

  
    

  create  table "superstore"."public_dw_test"."shipping_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник видов доставки
SELECT
    100 + row_number() OVER (ORDER BY "ship_mode") as ship_id,
    "ship_mode"
FROM (
    SELECT DISTINCT "ship_mode" FROM "superstore"."public_stg"."stg_orders"
) as unique_shipping_modes
  );
  
[0m12:25:52.814799 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4d36350>]}
[0m12:25:52.816724 [info ] [Thread-3 (]: 7 of 9 OK created sql table model public_dw_test.product_dim ................... [[32mSELECT 4544[0m in 0.20s]
[0m12:25:52.817583 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.product_dim
[0m12:25:52.823245 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.007 seconds
[0m12:25:52.829030 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:25:52.829650 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
alter table "superstore"."public_dw_test"."shipping_dim__dbt_tmp" rename to "shipping_dim"
[0m12:25:52.830639 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:25:52.832239 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m12:25:52.835014 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:25:52.835743 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m12:25:52.837996 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m12:25:52.840871 [debug] [Thread-4 (]: Applying DROP to: "superstore"."public_dw_test"."shipping_dim__dbt_backup"
[0m12:25:52.842080 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:25:52.842647 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
drop table if exists "superstore"."public_dw_test"."shipping_dim__dbt_backup" cascade
[0m12:25:52.843439 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:25:52.844788 [debug] [Thread-4 (]: On model.superstore_dwh.shipping_dim: Close
[0m12:25:52.846034 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b1d9bf10>]}
[0m12:25:52.847176 [info ] [Thread-4 (]: 8 of 9 OK created sql table model public_dw_test.shipping_dim .................. [[32mSELECT 4[0m in 0.12s]
[0m12:25:52.848332 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.shipping_dim
[0m12:25:52.849283 [debug] [Thread-1 (]: Began running node model.superstore_dwh.sales_fact
[0m12:25:52.850516 [info ] [Thread-1 (]: 9 of 9 START sql table model public_dw_test.sales_fact ......................... [RUN]
[0m12:25:52.851380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.geo_dim, now model.superstore_dwh.sales_fact)
[0m12:25:52.852311 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.sales_fact
[0m12:25:52.857064 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m12:25:52.857934 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.sales_fact
[0m12:25:52.862129 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.sales_fact"
[0m12:25:52.862955 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:25:52.863474 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: BEGIN
[0m12:25:52.864001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:52.870771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:25:52.871354 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:25:52.871943 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */

  
    

  create  table "superstore"."public_dw_test"."sales_fact__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу фактов, объединяя все измерения
SELECT
    -- Суррогатные ключи из измерений
    cd.cust_id,
    pd.prod_id,
    sd.ship_id,
    gd.geo_id,
    -- Ключи для календаря
    to_char(o.order_date, 'yyyymmdd')::int AS order_date_id,
    to_char(o.ship_date, 'yyyymmdd')::int AS ship_date_id,
    -- Бизнес-ключ и метрики
    o.order_id,
    o.sales,
    o.profit,
    o.quantity,
    o.discount
FROM "superstore"."public_stg"."stg_orders" AS o
LEFT JOIN "superstore"."public_dw_test"."customer_dim" AS cd ON o.customer_id = cd.customer_id
LEFT JOIN "superstore"."public_dw_test"."product_dim" AS pd ON o.product_id = pd.product_id
LEFT JOIN "superstore"."public_dw_test"."shipping_dim" AS sd ON o.ship_mode = sd.ship_mode
LEFT JOIN "superstore"."public_dw_test"."geo_dim" AS gd ON o.postal_code = gd.postal_code AND o.city = gd.city AND o.state = gd.state
  );
  
[0m12:25:52.962455 [debug] [Thread-1 (]: SQL status: SELECT 25867 in 0.089 seconds
[0m12:25:52.966504 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:25:52.967103 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
alter table "superstore"."public_dw_test"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m12:25:52.969779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:25:52.971561 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m12:25:52.972799 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:25:52.973416 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m12:25:52.982226 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m12:25:52.986856 [debug] [Thread-1 (]: Applying DROP to: "superstore"."public_dw_test"."sales_fact__dbt_backup"
[0m12:25:52.990309 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:25:52.990803 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
drop table if exists "superstore"."public_dw_test"."sales_fact__dbt_backup" cascade
[0m12:25:52.993123 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m12:25:52.996175 [debug] [Thread-1 (]: On model.superstore_dwh.sales_fact: Close
[0m12:25:52.997012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c073e0f0-ea7f-4b1d-9b97-ceab4157feeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b1dba0b0>]}
[0m12:25:52.997749 [info ] [Thread-1 (]: 9 of 9 OK created sql table model public_dw_test.sales_fact .................... [[32mSELECT 25867[0m in 0.15s]
[0m12:25:53.001178 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.sales_fact
[0m12:25:53.002704 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:53.004632 [debug] [MainThread]: On master: BEGIN
[0m12:25:53.005066 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:53.019559 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:25:53.021953 [debug] [MainThread]: On master: COMMIT
[0m12:25:53.022386 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:53.022744 [debug] [MainThread]: On master: COMMIT
[0m12:25:53.023386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:53.023819 [debug] [MainThread]: On master: Close
[0m12:25:53.027163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:53.029281 [debug] [MainThread]: Connection 'model.superstore_dwh.customer_dim' was properly closed.
[0m12:25:53.029825 [debug] [MainThread]: Connection 'model.superstore_dwh.product_dim' was properly closed.
[0m12:25:53.030182 [debug] [MainThread]: Connection 'model.superstore_dwh.sales_fact' was properly closed.
[0m12:25:53.030543 [debug] [MainThread]: Connection 'model.superstore_dwh.shipping_dim' was properly closed.
[0m12:25:53.034628 [info ] [MainThread]: 
[0m12:25:53.035695 [info ] [MainThread]: Finished running 7 table models, 2 view models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m12:25:53.039059 [debug] [MainThread]: Command end result
[0m12:25:53.098319 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:25:53.104336 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:25:53.123418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:25:53.123906 [info ] [MainThread]: 
[0m12:25:53.125376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:53.126519 [info ] [MainThread]: 
[0m12:25:53.127619 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m12:25:53.129209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0118573, "process_in_blocks": "88", "process_kernel_time": 0.239574, "process_mem_max_rss": "126468", "process_out_blocks": "3032", "process_user_time": 3.365971}
[0m12:25:53.129978 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:53.129835 after 3.01 seconds
[0m12:25:53.130450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b74b17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b640fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b8b4d213f0>]}
[0m12:25:53.130944 [debug] [MainThread]: Flushing usage events
[0m12:25:54.012243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:53.524274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a83ad6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a7360af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a7360a90>]}


============================== 12:32:53.526952 | 3ee3b34e-6240-4e9b-95a4-f47d4a5e124b ==============================
[0m12:32:53.526952 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:32:53.527521 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'empty': 'None', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'warn_error': 'None', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt clean', 'version_check': 'True', 'log_cache_events': 'False', 'profiles_dir': '/home/dev/.dbt'}
[0m12:32:53.658807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ee3b34e-6240-4e9b-95a4-f47d4a5e124b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a8270fa0>]}
[0m12:32:53.670340 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20312485, "process_in_blocks": "0", "process_kernel_time": 0.072869, "process_mem_max_rss": "96332", "process_out_blocks": "8", "process_user_time": 1.277705}
[0m12:32:53.670906 [debug] [MainThread]: Command `dbt clean` succeeded at 12:32:53.670807 after 0.20 seconds
[0m12:32:53.671342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a83ad6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a8270fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e39a72719f0>]}
[0m12:32:53.671893 [debug] [MainThread]: Flushing usage events
[0m12:32:54.366893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:10.521493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358b0a57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358a05cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358a05cca0>]}


============================== 12:33:10.524021 | 69a6ba34-b5b0-44c5-a1a3-ce79d20a129c ==============================
[0m12:33:10.524021 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:33:10.524700 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/dev/.dbt', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'debug': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'target_path': 'None', 'partial_parse': 'True'}
[0m12:33:10.686159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358cb1d480>]}
[0m12:33:10.758388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3589dcc400>]}
[0m12:33:10.760042 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:33:10.880985 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:33:10.881762 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:33:10.882203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35899580a0>]}
[0m12:33:12.218088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3587538130>]}
[0m12:33:12.313210 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:33:12.314872 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:33:12.325975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3587517070>]}
[0m12:33:12.326564 [info ] [MainThread]: Found 9 models, 4 data tests, 1 source, 435 macros
[0m12:33:12.327030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3587516230>]}
[0m12:33:12.328877 [info ] [MainThread]: 
[0m12:33:12.329344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:33:12.329819 [info ] [MainThread]: 
[0m12:33:12.330378 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:33:12.335234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:33:12.348478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:33:12.349869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m12:33:12.433678 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:33:12.434178 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:33:12.434688 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:33:12.435095 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m12:33:12.436410 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:33:12.435979 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m12:33:12.436805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:12.435465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:12.437237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:12.450314 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m12:33:12.453011 [debug] [ThreadPool]: On list_superstore: Close
[0m12:33:12.453900 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.018 seconds
[0m12:33:12.455281 [debug] [ThreadPool]: On list_superstore: Close
[0m12:33:12.455846 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.019 seconds
[0m12:33:12.457198 [debug] [ThreadPool]: On list_superstore: Close
[0m12:33:12.460889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_public)
[0m12:33:12.462556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_dw_test)
[0m12:33:12.461640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_stg)
[0m12:33:12.469201 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:33:12.474323 [debug] [ThreadPool]: On list_superstore_public: BEGIN
[0m12:33:12.473721 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:33:12.475147 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m12:33:12.474752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:12.471739 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:33:12.475532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:12.476472 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m12:33:12.477380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:12.485082 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:33:12.485662 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:33:12.486110 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m12:33:12.489283 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:33:12.491176 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m12:33:12.491743 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m12:33:12.492541 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:33:12.493383 [debug] [ThreadPool]: On list_superstore_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_public"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:33:12.494768 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m12:33:12.497171 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m12:33:12.497760 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:33:12.498200 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m12:33:12.498766 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:12.500007 [debug] [ThreadPool]: On list_superstore_public: ROLLBACK
[0m12:33:12.501753 [debug] [ThreadPool]: On list_superstore_public: Close
[0m12:33:12.503679 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m12:33:12.504897 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m12:33:12.505533 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m12:33:12.511819 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:12.512449 [debug] [MainThread]: On master: BEGIN
[0m12:33:12.512975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:12.519698 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:33:12.520289 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:12.520740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:33:12.523736 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m12:33:12.525659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358750a950>]}
[0m12:33:12.526319 [debug] [MainThread]: On master: ROLLBACK
[0m12:33:12.526987 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:12.527368 [debug] [MainThread]: On master: BEGIN
[0m12:33:12.528162 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:33:12.528551 [debug] [MainThread]: On master: COMMIT
[0m12:33:12.529008 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:12.529366 [debug] [MainThread]: On master: COMMIT
[0m12:33:12.530012 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:33:12.530710 [debug] [MainThread]: On master: Close
[0m12:33:12.533349 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m12:33:12.533989 [debug] [Thread-2 (]: Began running node model.superstore_dwh.my_first_dbt_model
[0m12:33:12.534972 [debug] [Thread-3 (]: Began running node model.superstore_dwh.stg_orders
[0m12:33:12.534552 [info ] [Thread-1 (]: 1 of 9 START sql table model dw_test.calendar_dim .............................. [RUN]
[0m12:33:12.535733 [info ] [Thread-2 (]: 2 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m12:33:12.536885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now model.superstore_dwh.calendar_dim)
[0m12:33:12.536359 [info ] [Thread-3 (]: 3 of 9 START sql view model stg.stg_orders ..................................... [RUN]
[0m12:33:12.538633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.superstore_dwh.stg_orders)
[0m12:33:12.538119 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m12:33:12.537599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_public, now model.superstore_dwh.my_first_dbt_model)
[0m12:33:12.547149 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.my_first_dbt_model
[0m12:33:12.546561 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m12:33:12.551912 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m12:33:12.551122 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.539099 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.stg_orders
[0m12:33:12.563222 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.my_first_dbt_model
[0m12:33:12.584444 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m12:33:12.598902 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.stg_orders
[0m12:33:12.598064 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.606709 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.607240 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: BEGIN
[0m12:33:12.593640 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.calendar_dim"
[0m12:33:12.618924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:12.627718 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.stg_orders"
[0m12:33:12.628905 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:33:12.630600 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:33:12.631586 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: BEGIN
[0m12:33:12.631983 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:33:12.631132 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: BEGIN
[0m12:33:12.632835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:12.637805 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m12:33:12.638382 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.638924 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */

  
    

  create  table "superstore"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:33:12.640387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:33:12.641321 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:33:12.641827 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */

  
    

  create  table "superstore"."dw_test"."calendar_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу-календарь
SELECT
    to_char(date,'yyyymmdd')::int as dateid,
    extract('year' from date)::int as year,
    extract('quarter' from date)::int as quarter,
    extract('month' from date)::int as month,
    extract('week' from date)::int as week,
    date::date,
    to_char(date, 'dy') as week_day,
    -- Проверка на високосный год
    CASE
        WHEN extract('day' from (date + interval '2 month - 1 day')) = 29 THEN 'leap'
        ELSE 'not leap'
    END as leap
FROM generate_series(
    date '2010-01-01',
    date '2030-12-31',
    interval '1 day'
) AS t(date)
  );
  
[0m12:33:12.642679 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.003 seconds
[0m12:33:12.655955 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.657123 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */
alter table "superstore"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:33:12.656440 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m12:33:12.658984 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:33:12.659489 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */

  create view "superstore"."stg"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
-- Эта модель читает данные из исходной таблицы stg.orders,
-- приводит их к нужным типам и исправляет ошибку с почтовым кодом.
-- Все последующие модели будут ссылаться на эту, а не на исходную таблицу.

SELECT
    -- Приводим все к нижнему регистру для консистентности в dbt
    "order_id",
    ("order_date")::date as order_date,
    ("ship_date")::date as ship_date,
    "ship_mode",
    "customer_id",
    "customer_name",
    "segment",
    "country",
    "city",
    "state",
    -- Исправляем проблему с Burlington прямо здесь, один раз и навсегда
    CASE
        WHEN "city" = 'Burlington' AND "postal_code" IS NULL THEN '05401'
        ELSE "postal_code"
    END as postal_code,
    "region",
    "product_id",
    "category",
    "subcategory" as sub_category, -- переименовываем для соответствия
    "product_name",
    "sales",
    "quantity",
    "discount",
    "profit"
FROM "superstore"."stg"."orders"
  );
[0m12:33:12.661847 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:33:12.665082 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.665670 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */
alter table "superstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:33:12.666521 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:33:12.674844 [debug] [Thread-1 (]: SQL status: SELECT 7670 in 0.032 seconds
[0m12:33:12.684053 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:33:12.686108 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: COMMIT
[0m12:33:12.687593 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.687108 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
alter table "superstore"."dw_test"."calendar_dim__dbt_tmp" rename to "calendar_dim"
[0m12:33:12.686608 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m12:33:12.688080 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: COMMIT
[0m12:33:12.691246 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:33:12.691818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:33:12.693059 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
alter table "superstore"."stg"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:33:12.694934 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m12:33:12.695746 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:33:12.696364 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m12:33:12.696825 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:12.697247 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: COMMIT
[0m12:33:12.704450 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m12:33:12.705215 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:33:12.705716 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: COMMIT
[0m12:33:12.703131 [debug] [Thread-2 (]: Applying DROP to: "superstore"."public"."my_first_dbt_model__dbt_backup"
[0m12:33:12.710298 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.my_first_dbt_model"
[0m12:33:12.711932 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_first_dbt_model"} */
drop table if exists "superstore"."public"."my_first_dbt_model__dbt_backup" cascade
[0m12:33:12.711420 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:33:12.710951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:33:12.715009 [debug] [Thread-3 (]: Applying DROP to: "superstore"."stg"."stg_orders__dbt_backup"
[0m12:33:12.718461 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."calendar_dim__dbt_backup"
[0m12:33:12.720929 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.stg_orders"
[0m12:33:12.721869 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.calendar_dim"
[0m12:33:12.722414 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.stg_orders"} */
drop view if exists "superstore"."stg"."stg_orders__dbt_backup" cascade
[0m12:33:12.723003 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.calendar_dim"} */
drop table if exists "superstore"."dw_test"."calendar_dim__dbt_backup" cascade
[0m12:33:12.723876 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:33:12.724393 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:33:12.726852 [debug] [Thread-1 (]: On model.superstore_dwh.calendar_dim: Close
[0m12:33:12.728582 [debug] [Thread-3 (]: On model.superstore_dwh.stg_orders: Close
[0m12:33:12.733018 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588989d80>]}
[0m12:33:12.734123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3587d2f280>]}
[0m12:33:12.733614 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.021 seconds
[0m12:33:12.734890 [info ] [Thread-3 (]: 3 of 9 OK created sql view model stg.stg_orders ................................ [[32mCREATE VIEW[0m in 0.19s]
[0m12:33:12.737118 [debug] [Thread-2 (]: On model.superstore_dwh.my_first_dbt_model: Close
[0m12:33:12.735756 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dw_test.calendar_dim ......................... [[32mSELECT 7670[0m in 0.20s]
[0m12:33:12.737996 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.stg_orders
[0m12:33:12.738840 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m12:33:12.739508 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358859f250>]}
[0m12:33:12.741481 [debug] [Thread-1 (]: Began running node model.superstore_dwh.product_dim
[0m12:33:12.740510 [debug] [Thread-4 (]: Began running node model.superstore_dwh.customer_dim
[0m12:33:12.741041 [debug] [Thread-3 (]: Began running node model.superstore_dwh.geo_dim
[0m12:33:12.742471 [info ] [Thread-2 (]: 2 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m12:33:12.747019 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.my_first_dbt_model
[0m12:33:12.743833 [info ] [Thread-4 (]: 4 of 9 START sql table model dw_test.customer_dim .............................. [RUN]
[0m12:33:12.743153 [info ] [Thread-1 (]: 6 of 9 START sql table model dw_test.product_dim ............................... [RUN]
[0m12:33:12.749132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.product_dim)
[0m12:33:12.747646 [debug] [Thread-2 (]: Began running node model.superstore_dwh.shipping_dim
[0m12:33:12.748574 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.customer_dim'
[0m12:33:12.751204 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.customer_dim
[0m12:33:12.749615 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.product_dim
[0m12:33:12.745022 [info ] [Thread-3 (]: 5 of 9 START sql table model dw_test.geo_dim ................................... [RUN]
[0m12:33:12.758162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.geo_dim)
[0m12:33:12.750593 [info ] [Thread-2 (]: 7 of 9 START sql table model dw_test.shipping_dim .............................. [RUN]
[0m12:33:12.759298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.my_first_dbt_model, now model.superstore_dwh.shipping_dim)
[0m12:33:12.758753 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.geo_dim
[0m12:33:12.757540 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m12:33:12.754696 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m12:33:12.763607 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.product_dim
[0m12:33:12.762772 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m12:33:12.759827 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m12:33:12.767509 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.customer_dim
[0m12:33:12.766982 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.product_dim"
[0m12:33:12.776401 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:33:12.776904 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: BEGIN
[0m12:33:12.770377 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m12:33:12.777928 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.shipping_dim
[0m12:33:12.775632 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_dwh.customer_dim"
[0m12:33:12.770915 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.geo_dim
[0m12:33:12.777322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:12.781113 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.shipping_dim"
[0m12:33:12.786994 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:33:12.785315 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_dwh.geo_dim"
[0m12:33:12.787571 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: BEGIN
[0m12:33:12.792097 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:12.794341 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:33:12.794956 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: BEGIN
[0m12:33:12.795395 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:33:12.803940 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:33:12.804459 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: BEGIN
[0m12:33:12.806158 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:33:12.805713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m12:33:12.806778 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:33:12.809115 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */

  
    

  create  table "superstore"."dw_test"."product_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник продуктов
SELECT
    100 + row_number() OVER (ORDER BY "product_id") as prod_id,
    "product_id",
    "product_name",
    "category",
    "sub_category",
    "segment"
FROM (
    SELECT DISTINCT "product_id", "product_name", "category", "sub_category", "segment" FROM "superstore"."stg"."stg_orders"
) as unique_products
  );
  
[0m12:33:12.819912 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m12:33:12.824441 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:33:12.825104 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */

  
    

  create  table "superstore"."dw_test"."shipping_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник видов доставки
SELECT
    100 + row_number() OVER (ORDER BY "ship_mode") as ship_id,
    "ship_mode"
FROM (
    SELECT DISTINCT "ship_mode" FROM "superstore"."stg"."stg_orders"
) as unique_shipping_modes
  );
  
[0m12:33:12.837371 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m12:33:12.839233 [debug] [Thread-1 (]: SQL status: SELECT 4544 in 0.030 seconds
[0m12:33:12.840894 [debug] [Thread-3 (]: SQL status: BEGIN in 0.035 seconds
[0m12:33:12.845518 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:33:12.841816 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.016 seconds
[0m12:33:12.844934 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:33:12.852539 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
alter table "superstore"."dw_test"."product_dim__dbt_tmp" rename to "product_dim"
[0m12:33:12.841357 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:33:12.845988 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */

  
    

  create  table "superstore"."dw_test"."geo_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает географический справочник
SELECT
    100 + row_number() OVER (ORDER BY "postal_code", "city", "state") as geo_id,
    "country",
    "city",
    "state",
    "postal_code"
FROM (
    SELECT DISTINCT "country", "city", "state", "postal_code" FROM "superstore"."stg"."stg_orders"
) as unique_geo
  );
  
[0m12:33:12.854065 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */

  
    

  create  table "superstore"."dw_test"."customer_dim__dbt_tmp"
  
  
    as
  
  (
    -- Создает справочник клиентов
SELECT
    100 + row_number() OVER (ORDER BY "customer_id") as cust_id,
    "customer_id",
    "customer_name"
FROM (
    SELECT DISTINCT "customer_id", "customer_name" FROM "superstore"."stg"."stg_orders"
) as unique_customers
  );
  
[0m12:33:12.854679 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:33:12.858016 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
alter table "superstore"."dw_test"."shipping_dim__dbt_tmp" rename to "shipping_dim"
[0m12:33:12.855248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:33:12.866814 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: COMMIT
[0m12:33:12.873195 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:33:12.873778 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: COMMIT
[0m12:33:12.874614 [debug] [Thread-4 (]: SQL status: SELECT 993 in 0.018 seconds
[0m12:33:12.881882 [debug] [Thread-3 (]: SQL status: SELECT 832 in 0.026 seconds
[0m12:33:12.895183 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:33:12.896172 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m12:33:12.898302 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m12:33:12.896913 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
alter table "superstore"."dw_test"."customer_dim__dbt_tmp" rename to "customer_dim"
[0m12:33:12.895707 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m12:33:12.887357 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:33:12.903881 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
alter table "superstore"."dw_test"."geo_dim__dbt_tmp" rename to "geo_dim"
[0m12:33:12.904797 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:33:12.898908 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:33:12.907056 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: COMMIT
[0m12:33:12.903239 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_test"."product_dim__dbt_backup"
[0m12:33:12.906568 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:33:12.906134 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m12:33:12.907881 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.product_dim"
[0m12:33:12.909442 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m12:33:12.910768 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:12.911577 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:33:12.912077 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.product_dim"} */
drop table if exists "superstore"."dw_test"."product_dim__dbt_backup" cascade
[0m12:33:12.914092 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:33:12.916779 [debug] [Thread-2 (]: Applying DROP to: "superstore"."dw_test"."shipping_dim__dbt_backup"
[0m12:33:12.917362 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: COMMIT
[0m12:33:12.918092 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: COMMIT
[0m12:33:12.919323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:33:12.920913 [debug] [Thread-1 (]: On model.superstore_dwh.product_dim: Close
[0m12:33:12.918884 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.shipping_dim"
[0m12:33:12.923409 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.shipping_dim"} */
drop table if exists "superstore"."dw_test"."shipping_dim__dbt_backup" cascade
[0m12:33:12.924259 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:33:12.925127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35859b31c0>]}
[0m12:33:12.929105 [debug] [Thread-3 (]: Applying DROP to: "superstore"."dw_test"."geo_dim__dbt_backup"
[0m12:33:12.926358 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:33:12.925869 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:33:12.930627 [debug] [Thread-3 (]: Using postgres connection "model.superstore_dwh.geo_dim"
[0m12:33:12.935719 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.geo_dim"} */
drop table if exists "superstore"."dw_test"."geo_dim__dbt_backup" cascade
[0m12:33:12.935013 [debug] [Thread-4 (]: Applying DROP to: "superstore"."dw_test"."customer_dim__dbt_backup"
[0m12:33:12.929916 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dw_test.product_dim .......................... [[32mSELECT 4544[0m in 0.18s]
[0m12:33:12.932249 [debug] [Thread-2 (]: On model.superstore_dwh.shipping_dim: Close
[0m12:33:12.939954 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358750b460>]}
[0m12:33:12.937118 [debug] [Thread-4 (]: Using postgres connection "model.superstore_dwh.customer_dim"
[0m12:33:12.939052 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.product_dim
[0m12:33:12.941399 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.customer_dim"} */
drop table if exists "superstore"."dw_test"."customer_dim__dbt_backup" cascade
[0m12:33:12.945124 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:33:12.937692 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:33:12.942458 [debug] [Thread-1 (]: Began running node model.superstore_dwh.my_second_dbt_model
[0m12:33:12.940749 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dw_test.shipping_dim ......................... [[32mSELECT 4[0m in 0.18s]
[0m12:33:12.950898 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.shipping_dim
[0m12:33:12.948980 [debug] [Thread-3 (]: On model.superstore_dwh.geo_dim: Close
[0m12:33:12.947490 [debug] [Thread-4 (]: On model.superstore_dwh.customer_dim: Close
[0m12:33:12.950202 [info ] [Thread-1 (]: 8 of 9 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m12:33:12.952411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.product_dim, now model.superstore_dwh.my_second_dbt_model)
[0m12:33:12.954820 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588ddb130>]}
[0m12:33:12.956872 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588dbe1a0>]}
[0m12:33:12.957596 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.my_second_dbt_model
[0m12:33:12.959514 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dw_test.customer_dim ......................... [[32mSELECT 993[0m in 0.21s]
[0m12:33:12.967014 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.customer_dim
[0m12:33:12.967402 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.my_second_dbt_model"
[0m12:33:12.960187 [info ] [Thread-3 (]: 5 of 9 OK created sql table model dw_test.geo_dim .............................. [[32mSELECT 832[0m in 0.20s]
[0m12:33:12.971359 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.my_second_dbt_model
[0m12:33:12.972899 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.geo_dim
[0m12:33:12.980472 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_dwh.my_second_dbt_model"
[0m12:33:12.981253 [debug] [Thread-2 (]: Began running node model.superstore_dwh.sales_fact
[0m12:33:12.983048 [info ] [Thread-2 (]: 9 of 9 START sql table model dw_test.sales_fact ................................ [RUN]
[0m12:33:12.983759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.shipping_dim, now model.superstore_dwh.sales_fact)
[0m12:33:12.984242 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.sales_fact
[0m12:33:12.982340 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:33:12.993728 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: BEGIN
[0m12:33:12.992994 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m12:33:12.994180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:12.997740 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.sales_fact
[0m12:33:13.013527 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_dwh.sales_fact"
[0m12:33:13.016272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m12:33:13.018083 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:33:13.017452 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:33:13.019964 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: BEGIN
[0m12:33:13.020366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:13.019065 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */

  create view "superstore"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "superstore"."public"."my_first_dbt_model"
where id = 1
  );
[0m12:33:13.023061 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:33:13.031383 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:33:13.033958 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */
alter table "superstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:33:13.036900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:33:13.038853 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m12:33:13.042862 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:33:13.043449 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */

  
    

  create  table "superstore"."dw_test"."sales_fact__dbt_tmp"
  
  
    as
  
  (
    -- Создает таблицу фактов, объединяя все измерения
SELECT
    -- Суррогатные ключи из измерений
    cd.cust_id,
    pd.prod_id,
    sd.ship_id,
    gd.geo_id,
    -- Ключи для календаря
    to_char(o.order_date, 'yyyymmdd')::int AS order_date_id,
    to_char(o.ship_date, 'yyyymmdd')::int AS ship_date_id,
    -- Бизнес-ключ и метрики
    o.order_id,
    o.sales,
    o.profit,
    o.quantity,
    o.discount
FROM "superstore"."stg"."stg_orders" AS o
LEFT JOIN "superstore"."dw_test"."customer_dim" AS cd ON o.customer_id = cd.customer_id
LEFT JOIN "superstore"."dw_test"."product_dim" AS pd ON o.product_id = pd.product_id
LEFT JOIN "superstore"."dw_test"."shipping_dim" AS sd ON o.ship_mode = sd.ship_mode
LEFT JOIN "superstore"."dw_test"."geo_dim" AS gd ON o.postal_code = gd.postal_code AND o.city = gd.city AND o.state = gd.state
  );
  
[0m12:33:13.040165 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: COMMIT
[0m12:33:13.045847 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:33:13.050273 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: COMMIT
[0m12:33:13.054751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:13.067407 [debug] [Thread-1 (]: Applying DROP to: "superstore"."public"."my_second_dbt_model__dbt_backup"
[0m12:33:13.071657 [debug] [Thread-1 (]: Using postgres connection "model.superstore_dwh.my_second_dbt_model"
[0m12:33:13.072399 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.my_second_dbt_model"} */
drop view if exists "superstore"."public"."my_second_dbt_model__dbt_backup" cascade
[0m12:33:13.075788 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:33:13.079458 [debug] [Thread-1 (]: On model.superstore_dwh.my_second_dbt_model: Close
[0m12:33:13.082719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358c8c0b50>]}
[0m12:33:13.085753 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:33:13.086494 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.my_second_dbt_model
[0m12:33:13.141500 [debug] [Thread-2 (]: SQL status: SELECT 25867 in 0.097 seconds
[0m12:33:13.149063 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:33:13.149637 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
alter table "superstore"."dw_test"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m12:33:13.150406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:33:13.152207 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m12:33:13.152756 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:33:13.153186 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: COMMIT
[0m12:33:13.164816 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m12:33:13.168330 [debug] [Thread-2 (]: Applying DROP to: "superstore"."dw_test"."sales_fact__dbt_backup"
[0m12:33:13.169387 [debug] [Thread-2 (]: Using postgres connection "model.superstore_dwh.sales_fact"
[0m12:33:13.169907 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "model.superstore_dwh.sales_fact"} */
drop table if exists "superstore"."dw_test"."sales_fact__dbt_backup" cascade
[0m12:33:13.170733 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:33:13.172322 [debug] [Thread-2 (]: On model.superstore_dwh.sales_fact: Close
[0m12:33:13.174596 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69a6ba34-b5b0-44c5-a1a3-ce79d20a129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3567765c60>]}
[0m12:33:13.176678 [info ] [Thread-2 (]: 9 of 9 OK created sql table model dw_test.sales_fact ........................... [[32mSELECT 25867[0m in 0.19s]
[0m12:33:13.177437 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.sales_fact
[0m12:33:13.179146 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:13.179700 [debug] [MainThread]: On master: BEGIN
[0m12:33:13.180132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:13.188382 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:33:13.188953 [debug] [MainThread]: On master: COMMIT
[0m12:33:13.189344 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:13.189780 [debug] [MainThread]: On master: COMMIT
[0m12:33:13.190473 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:33:13.190905 [debug] [MainThread]: On master: Close
[0m12:33:13.192003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:13.192401 [debug] [MainThread]: Connection 'model.superstore_dwh.my_second_dbt_model' was properly closed.
[0m12:33:13.195838 [debug] [MainThread]: Connection 'model.superstore_dwh.sales_fact' was properly closed.
[0m12:33:13.196310 [debug] [MainThread]: Connection 'model.superstore_dwh.geo_dim' was properly closed.
[0m12:33:13.199830 [debug] [MainThread]: Connection 'model.superstore_dwh.customer_dim' was properly closed.
[0m12:33:13.200327 [info ] [MainThread]: 
[0m12:33:13.202676 [info ] [MainThread]: Finished running 7 table models, 2 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m12:33:13.206078 [debug] [MainThread]: Command end result
[0m12:33:13.247938 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:33:13.249897 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:33:13.262076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:33:13.262590 [info ] [MainThread]: 
[0m12:33:13.264522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:13.265660 [info ] [MainThread]: 
[0m12:33:13.266714 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m12:33:13.268541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8046427, "process_in_blocks": "0", "process_kernel_time": 0.225063, "process_mem_max_rss": "126932", "process_out_blocks": "3016", "process_user_time": 3.420155}
[0m12:33:13.269363 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:13.269263 after 2.81 seconds
[0m12:33:13.271025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358b0a57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f358bc7b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588df7be0>]}
[0m12:33:13.271557 [debug] [MainThread]: Flushing usage events
[0m12:33:14.058248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:49.224169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5b6ad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5a668220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5a6681c0>]}


============================== 12:35:49.226882 | 5dfd62e3-c694-45bc-8b26-36169c93ddf9 ==============================
[0m12:35:49.226882 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:35:49.227525 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt test', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': '/home/dev/.dbt', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'indirect_selection': 'eager'}
[0m12:35:49.391331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5a60af80>]}
[0m12:35:49.453724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5a66be80>]}
[0m12:35:49.454621 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:35:49.538299 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:35:49.678180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:49.678669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:49.732693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c58fb7e50>]}
[0m12:35:49.832629 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:35:49.834488 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:35:49.894926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5a784460>]}
[0m12:35:49.895571 [info ] [MainThread]: Found 9 models, 4 data tests, 1 source, 435 macros
[0m12:35:49.896037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5d15c4c0>]}
[0m12:35:49.897888 [info ] [MainThread]: 
[0m12:35:49.898350 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:49.898821 [info ] [MainThread]: 
[0m12:35:49.899446 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:35:49.904348 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m12:35:49.912489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_public'
[0m12:35:49.922255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m12:35:49.944894 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:35:49.945467 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m12:35:49.945922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:49.947504 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:35:49.948089 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:35:49.954413 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m12:35:49.954842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:49.953199 [debug] [ThreadPool]: On list_superstore_public: BEGIN
[0m12:35:49.955884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:49.958351 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:35:49.958911 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:35:49.960441 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m12:35:49.964958 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:35:49.968804 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m12:35:49.972252 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m12:35:49.972861 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:35:49.973270 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m12:35:49.973793 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m12:35:49.978687 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m12:35:49.980769 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m12:35:49.981199 [debug] [ThreadPool]: Using postgres connection "list_superstore_public"
[0m12:35:49.982537 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m12:35:49.983862 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m12:35:49.983242 [debug] [ThreadPool]: On list_superstore_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_public"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:35:49.990515 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m12:35:49.991877 [debug] [ThreadPool]: On list_superstore_public: ROLLBACK
[0m12:35:49.996766 [debug] [ThreadPool]: On list_superstore_public: Close
[0m12:35:50.004271 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.004813 [debug] [MainThread]: On master: BEGIN
[0m12:35:50.005180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:50.012887 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:35:50.013482 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.014398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:35:50.017823 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m12:35:50.019988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfd62e3-c694-45bc-8b26-36169c93ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5d1614e0>]}
[0m12:35:50.020578 [debug] [MainThread]: On master: ROLLBACK
[0m12:35:50.021236 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.021785 [debug] [MainThread]: On master: BEGIN
[0m12:35:50.022589 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:35:50.023066 [debug] [MainThread]: On master: COMMIT
[0m12:35:50.023516 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.023961 [debug] [MainThread]: On master: COMMIT
[0m12:35:50.024607 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:35:50.025105 [debug] [MainThread]: On master: Close
[0m12:35:50.029038 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:50.030653 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:50.031501 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321
[0m12:35:50.032621 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:50.030219 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m12:35:50.035257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_public, now test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710)
[0m12:35:50.035805 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:50.032010 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m12:35:50.042197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778)
[0m12:35:50.033676 [info ] [Thread-3 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m12:35:50.034645 [info ] [Thread-4 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m12:35:50.056093 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493'
[0m12:35:50.056627 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:50.050148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321)
[0m12:35:50.067083 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321
[0m12:35:50.055321 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:35:50.072928 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:50.042776 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:50.072016 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321"
[0m12:35:50.066478 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:35:50.094684 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:50.089502 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:35:50.093863 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778"
[0m12:35:50.098462 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321
[0m12:35:50.100898 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321"
[0m12:35:50.102163 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321"
[0m12:35:50.097813 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:35:50.103149 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m12:35:50.103600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:50.101579 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:50.097088 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:35:50.110596 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:35:50.111110 [debug] [Thread-4 (]: On test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m12:35:50.102689 [debug] [Thread-3 (]: On test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m12:35:50.112349 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:35:50.113313 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778"
[0m12:35:50.114539 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778"
[0m12:35:50.111545 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:35:50.114995 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m12:35:50.117445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:50.118805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m12:35:50.121878 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:35:50.122386 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "superstore"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m12:35:50.128012 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:35:50.136937 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m12:35:50.138016 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m12:35:50.141855 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m12:35:50.143786 [debug] [Thread-4 (]: SQL status: BEGIN in 0.032 seconds
[0m12:35:50.148987 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m12:35:50.140278 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.10s]
[0m12:35:50.149777 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321"
[0m12:35:50.150294 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:35:50.151318 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778"
[0m12:35:50.154703 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "superstore"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m12:35:50.152280 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:35:50.153476 [debug] [Thread-3 (]: On test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "superstore"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:35:50.154097 [debug] [Thread-4 (]: On test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "superstore"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:35:50.157164 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:50.159878 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m12:35:50.163707 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:35:50.164174 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:35:50.171251 [debug] [Thread-3 (]: On test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m12:35:50.171998 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778: Close
[0m12:35:50.169624 [debug] [Thread-4 (]: On test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m12:35:50.177792 [debug] [Thread-4 (]: On test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m12:35:50.173964 [debug] [Thread-3 (]: On test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321: Close
[0m12:35:50.176275 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.13s]
[0m12:35:50.179737 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.12s]
[0m12:35:50.184998 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493
[0m12:35:50.183309 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778
[0m12:35:50.182294 [info ] [Thread-3 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.13s]
[0m12:35:50.186023 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321
[0m12:35:50.188897 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.189377 [debug] [MainThread]: On master: BEGIN
[0m12:35:50.191010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:50.203215 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:35:50.203738 [debug] [MainThread]: On master: COMMIT
[0m12:35:50.204935 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:50.205848 [debug] [MainThread]: On master: COMMIT
[0m12:35:50.207476 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:35:50.207927 [debug] [MainThread]: On master: Close
[0m12:35:50.209841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:50.210485 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m12:35:50.212819 [debug] [MainThread]: Connection 'test.superstore_dwh.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m12:35:50.213238 [debug] [MainThread]: Connection 'test.superstore_dwh.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m12:35:50.213681 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m12:35:50.214201 [info ] [MainThread]: 
[0m12:35:50.214777 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m12:35:50.216078 [debug] [MainThread]: Command end result
[0m12:35:50.251015 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:35:50.255059 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:35:50.269716 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:35:50.270186 [info ] [MainThread]: 
[0m12:35:50.271777 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:35:50.272982 [info ] [MainThread]: 
[0m12:35:50.274153 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m12:35:50.275194 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:35:50.275872 [info ] [MainThread]: 
[0m12:35:50.277378 [info ] [MainThread]:   compiled code at target/compiled/superstore_dwh/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m12:35:50.278431 [info ] [MainThread]: 
[0m12:35:50.279479 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m12:35:50.281036 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.113934, "process_in_blocks": "0", "process_kernel_time": 0.161223, "process_mem_max_rss": "118248", "process_out_blocks": "1960", "process_user_time": 1.999962}
[0m12:35:50.282767 [debug] [MainThread]: Command `dbt test` failed at 12:35:50.282609 after 1.12 seconds
[0m12:35:50.283387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c5b6ad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c59b00370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c59b015d0>]}
[0m12:35:50.283968 [debug] [MainThread]: Flushing usage events
[0m12:35:50.956917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:06.169807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7403ad7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73f368220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73f3681c0>]}


============================== 12:39:06.172412 | 55ee2158-f503-4e12-92b6-b52f7799b778 ==============================
[0m12:39:06.172412 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:39:06.173037 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt test', 'target_path': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '/home/dev/.dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'fail_fast': 'False'}
[0m12:39:06.337044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73f30af50>]}
[0m12:39:06.403075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73fb882b0>]}
[0m12:39:06.403925 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:39:06.490884 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:39:06.629506 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m12:39:06.630230 [debug] [MainThread]: Partial parsing: added file: superstore_dwh://models/marts/schema.yml
[0m12:39:06.630735 [debug] [MainThread]: Partial parsing: deleted file: superstore_dwh://models/example/my_second_dbt_model.sql
[0m12:39:06.631095 [debug] [MainThread]: Partial parsing: deleted file: superstore_dwh://models/example/my_first_dbt_model.sql
[0m12:39:06.848451 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:39:06.849107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73f26a530>]}
[0m12:39:06.965705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73f57ef20>]}
[0m12:39:07.062086 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:39:07.063852 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:39:07.083466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73d795c30>]}
[0m12:39:07.084059 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m12:39:07.084557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73d7962f0>]}
[0m12:39:07.086709 [info ] [MainThread]: 
[0m12:39:07.087362 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:07.087843 [info ] [MainThread]: 
[0m12:39:07.088590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:07.093747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m12:39:07.101228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m12:39:07.134426 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:39:07.134895 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:39:07.135848 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m12:39:07.136246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:07.135430 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m12:39:07.138116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:07.148422 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:39:07.149036 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:39:07.149531 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m12:39:07.152492 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m12:39:07.154328 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m12:39:07.155129 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m12:39:07.157118 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:39:07.157630 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m12:39:07.158086 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m12:39:07.162096 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m12:39:07.163638 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m12:39:07.164763 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m12:39:07.172528 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.173161 [debug] [MainThread]: On master: BEGIN
[0m12:39:07.173554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:07.180233 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:39:07.180761 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.181194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:39:07.184200 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m12:39:07.186105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ee2158-f503-4e12-92b6-b52f7799b778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73d7974c0>]}
[0m12:39:07.186638 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:07.187569 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.188028 [debug] [MainThread]: On master: BEGIN
[0m12:39:07.188653 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:39:07.189118 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.189506 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.189941 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.190421 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:07.190850 [debug] [MainThread]: On master: Close
[0m12:39:07.194749 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:39:07.195658 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:39:07.196387 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:39:07.197186 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:39:07.195261 [info ] [Thread-1 (]: 1 of 9 START test not_null_customer_dim_cust_id ................................ [RUN]
[0m12:39:07.198879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m12:39:07.199325 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:39:07.196080 [info ] [Thread-2 (]: 2 of 9 START test not_null_geo_dim_geo_id ...................................... [RUN]
[0m12:39:07.212304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m12:39:07.196879 [info ] [Thread-3 (]: 3 of 9 START test not_null_product_dim_prod_id ................................. [RUN]
[0m12:39:07.215926 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:39:07.218105 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:39:07.216738 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:39:07.217417 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688'
[0m12:39:07.246681 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:39:07.198218 [info ] [Thread-4 (]: 4 of 9 START test not_null_shipping_dim_ship_id ................................ [RUN]
[0m12:39:07.251224 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d'
[0m12:39:07.251697 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:39:07.245986 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:39:07.257569 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:39:07.258059 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m12:39:07.258484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:07.250523 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:39:07.259199 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:39:07.256316 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:39:07.263699 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:39:07.255724 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:39:07.262958 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:39:07.273548 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:39:07.274041 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m12:39:07.274447 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:39:07.272672 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:39:07.278333 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:39:07.282187 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:39:07.278881 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:39:07.284935 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:39:07.285430 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m12:39:07.285899 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:07.281459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m12:39:07.287706 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:39:07.288217 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_test"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:07.282724 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m12:39:07.289460 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:39:07.291014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:07.300770 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m12:39:07.302031 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m12:39:07.302574 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:39:07.303053 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_test"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:07.303744 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m12:39:07.308191 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:39:07.313052 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m12:39:07.310813 [info ] [Thread-1 (]: 1 of 9 PASS not_null_customer_dim_cust_id ...................................... [[32mPASS[0m in 0.11s]
[0m12:39:07.314208 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:39:07.314835 [debug] [Thread-1 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:39:07.316191 [info ] [Thread-1 (]: 5 of 9 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ . [RUN]
[0m12:39:07.316910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m12:39:07.315387 [debug] [Thread-2 (]: SQL status: BEGIN in 0.029 seconds
[0m12:39:07.317360 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:39:07.320927 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m12:39:07.326791 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:39:07.319787 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m12:39:07.328068 [info ] [Thread-3 (]: 3 of 9 PASS not_null_product_dim_prod_id ....................................... [[32mPASS[0m in 0.11s]
[0m12:39:07.326181 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:39:07.320317 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:39:07.332302 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_test"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:07.327316 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_test"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:07.328913 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:39:07.329728 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:39:07.333953 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:39:07.335264 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:07.339860 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:39:07.340401 [info ] [Thread-3 (]: 6 of 9 START test unique_customer_dim_cust_id .................................. [RUN]
[0m12:39:07.345599 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m12:39:07.339052 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:39:07.353123 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:39:07.353687 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m12:39:07.354123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:07.349439 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m12:39:07.351255 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m12:39:07.357815 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:39:07.354597 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m12:39:07.366525 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m12:39:07.367544 [info ] [Thread-2 (]: 2 of 9 PASS not_null_geo_dim_geo_id ............................................ [[32mPASS[0m in 0.16s]
[0m12:39:07.375861 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:39:07.376596 [info ] [Thread-4 (]: 4 of 9 PASS not_null_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.13s]
[0m12:39:07.381688 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:39:07.380879 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:39:07.379044 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:39:07.385240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m12:39:07.383451 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:39:07.386352 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:39:07.386886 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:39:07.385821 [info ] [Thread-2 (]: 7 of 9 START test unique_geo_dim_geo_id ........................................ [RUN]
[0m12:39:07.395854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m12:39:07.396382 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:39:07.395037 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_test"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_test"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:39:07.388056 [info ] [Thread-4 (]: 8 of 9 START test unique_product_dim_prod_id ................................... [RUN]
[0m12:39:07.403684 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m12:39:07.401826 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:39:07.404937 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:39:07.391280 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:39:07.404309 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:39:07.407676 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:39:07.416984 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:39:07.417488 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m12:39:07.417917 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:07.409075 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:39:07.415738 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m12:39:07.422366 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m12:39:07.414678 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:39:07.420671 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m12:39:07.424169 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:39:07.427770 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m12:39:07.436269 [info ] [Thread-1 (]: 5 of 9 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ....... [[32mPASS[0m in 0.12s]
[0m12:39:07.434037 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:39:07.429331 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:39:07.437229 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:39:07.438749 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m12:39:07.440409 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:39:07.444811 [debug] [Thread-4 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m12:39:07.445259 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:39:07.441248 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:39:07.444029 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:39:07.448732 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:07.446339 [info ] [Thread-1 (]: 9 of 9 START test unique_shipping_dim_ship_id .................................. [RUN]
[0m12:39:07.450690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m12:39:07.455768 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:39:07.456756 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:39:07.466737 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m12:39:07.470434 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m12:39:07.468501 [debug] [Thread-3 (]: SQL status: BEGIN in 0.040 seconds
[0m12:39:07.476577 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:39:07.469073 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:39:07.474277 [info ] [Thread-2 (]: 7 of 9 PASS unique_geo_dim_geo_id .............................................. [[32mPASS[0m in 0.08s]
[0m12:39:07.469559 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m12:39:07.479943 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:39:07.480421 [debug] [Thread-4 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:07.478925 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:39:07.481126 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:39:07.477710 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:07.489640 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:39:07.493029 [debug] [Thread-4 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m12:39:07.494061 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:39:07.486442 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:39:07.498806 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:39:07.499328 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m12:39:07.497567 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m12:39:07.502509 [debug] [Thread-3 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m12:39:07.500621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:07.501589 [debug] [Thread-4 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m12:39:07.504306 [info ] [Thread-3 (]: 6 of 9 PASS unique_customer_dim_cust_id ........................................ [[32mPASS[0m in 0.15s]
[0m12:39:07.515098 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:39:07.513025 [info ] [Thread-4 (]: 8 of 9 PASS unique_product_dim_prod_id ......................................... [[32mPASS[0m in 0.11s]
[0m12:39:07.518254 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:39:07.528548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m12:39:07.529120 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:39:07.532122 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:07.534982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:07.537011 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m12:39:07.541914 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m12:39:07.544831 [info ] [Thread-1 (]: 9 of 9 PASS unique_shipping_dim_ship_id ........................................ [[32mPASS[0m in 0.09s]
[0m12:39:07.547727 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:39:07.550395 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.552077 [debug] [MainThread]: On master: BEGIN
[0m12:39:07.553037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:07.566156 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:39:07.567351 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.568243 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.569140 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.570398 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:39:07.570900 [debug] [MainThread]: On master: Close
[0m12:39:07.572845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:07.573307 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m12:39:07.578153 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m12:39:07.579098 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721' was properly closed.
[0m12:39:07.579485 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m12:39:07.581797 [info ] [MainThread]: 
[0m12:39:07.583531 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m12:39:07.589161 [debug] [MainThread]: Command end result
[0m12:39:07.652828 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:39:07.656747 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:39:07.671775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:39:07.672293 [info ] [MainThread]: 
[0m12:39:07.673131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:07.673931 [info ] [MainThread]: 
[0m12:39:07.674594 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m12:39:07.675408 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:39:07.677766 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5652375, "process_in_blocks": "0", "process_kernel_time": 0.168978, "process_mem_max_rss": "122340", "process_out_blocks": "3016", "process_user_time": 2.343696}
[0m12:39:07.678704 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:07.678522 after 1.57 seconds
[0m12:39:07.679169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7403ad7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73d796c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73d795330>]}
[0m12:39:07.679907 [debug] [MainThread]: Flushing usage events
[0m12:39:08.284246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:54.871902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c937ad810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c92768220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c927681c0>]}


============================== 12:41:54.874603 | 3fb7da91-f06a-40b9-8621-5054df2e5a9b ==============================
[0m12:41:54.874603 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:41:54.875219 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'profiles_dir': '/home/dev/.dbt'}
[0m12:41:55.037770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c9270a080>]}
[0m12:41:55.099017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c92fe6bc0>]}
[0m12:41:55.099865 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:41:55.199325 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:41:55.332181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:41:55.333088 [debug] [MainThread]: Partial parsing: updated file: superstore_dwh://models/marts/schema.yml
[0m12:41:55.810915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c90374a00>]}
[0m12:41:55.902770 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:41:55.904521 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:41:55.925466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c90377220>]}
[0m12:41:55.926091 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m12:41:55.926504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c90377700>]}
[0m12:41:55.928464 [info ] [MainThread]: 
[0m12:41:55.928982 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:55.929348 [info ] [MainThread]: 
[0m12:41:55.929954 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:41:55.935500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m12:41:55.941637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m12:41:55.981337 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:41:55.983499 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m12:41:55.981963 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:41:55.984409 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m12:41:55.984734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:55.984010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:55.997267 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:41:55.998074 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:41:55.998618 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m12:41:56.001734 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m12:41:56.003433 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m12:41:56.004782 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m12:41:56.006004 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:41:56.005541 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m12:41:56.006383 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m12:41:56.011662 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m12:41:56.012985 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m12:41:56.014863 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m12:41:56.022716 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.023426 [debug] [MainThread]: On master: BEGIN
[0m12:41:56.023892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:56.031270 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:41:56.032142 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.032626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:41:56.036116 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m12:41:56.038355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb7da91-f06a-40b9-8621-5054df2e5a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c903d8f10>]}
[0m12:41:56.038968 [debug] [MainThread]: On master: ROLLBACK
[0m12:41:56.039850 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.040277 [debug] [MainThread]: On master: BEGIN
[0m12:41:56.040994 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:41:56.041422 [debug] [MainThread]: On master: COMMIT
[0m12:41:56.042061 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.042454 [debug] [MainThread]: On master: COMMIT
[0m12:41:56.043034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:41:56.043460 [debug] [MainThread]: On master: Close
[0m12:41:56.047717 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:41:56.048596 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:41:56.049696 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:41:56.050420 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:41:56.048240 [info ] [Thread-1 (]: 1 of 9 START test not_null_customer_dim_cust_id ................................ [RUN]
[0m12:41:56.049039 [info ] [Thread-2 (]: 2 of 9 START test not_null_geo_dim_geo_id ...................................... [RUN]
[0m12:41:56.050120 [info ] [Thread-3 (]: 3 of 9 START test not_null_product_dim_prod_id ................................. [RUN]
[0m12:41:56.052109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m12:41:56.053922 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:41:56.051136 [info ] [Thread-4 (]: 4 of 9 START test not_null_shipping_dim_ship_id ................................ [RUN]
[0m12:41:56.060852 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d'
[0m12:41:56.061352 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:41:56.052728 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m12:41:56.053412 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688'
[0m12:41:56.069425 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:41:56.072541 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:41:56.078315 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:41:56.073618 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:41:56.073171 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:41:56.104598 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:41:56.077537 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:41:56.109487 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:41:56.103700 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:41:56.108597 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:41:56.113313 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:41:56.112275 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:41:56.105392 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:41:56.115942 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:41:56.114924 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m12:41:56.116481 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m12:41:56.114017 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:41:56.119460 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:41:56.120140 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:41:56.120679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:56.123694 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m12:41:56.125459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:56.123190 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:41:56.129778 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:41:56.130262 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m12:41:56.131436 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:41:56.133881 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m12:41:56.134408 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:41:56.140337 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_test"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m12:41:56.142475 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:41:56.150896 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m12:41:56.152842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m12:41:56.154117 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m12:41:56.153518 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m12:41:56.154753 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:41:56.155423 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m12:41:56.156463 [info ] [Thread-4 (]: 4 of 9 PASS not_null_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.10s]
[0m12:41:56.159064 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:41:56.159562 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_test"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m12:41:56.160051 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:41:56.160675 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:41:56.161185 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_test"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m12:41:56.161779 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_test"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m12:41:56.162661 [debug] [Thread-4 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:41:56.164962 [info ] [Thread-4 (]: 5 of 9 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ . [RUN]
[0m12:41:56.163292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:41:56.167985 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m12:41:56.168745 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:41:56.178293 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m12:41:56.170823 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m12:41:56.176839 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:41:56.174048 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m12:41:56.186167 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m12:41:56.188262 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m12:41:56.186704 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m12:41:56.184153 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:41:56.192185 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:41:56.190111 [info ] [Thread-1 (]: 1 of 9 PASS not_null_customer_dim_cust_id ...................................... [[32mPASS[0m in 0.14s]
[0m12:41:56.199406 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:41:56.199955 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:41:56.200763 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m12:41:56.191443 [info ] [Thread-2 (]: 2 of 9 PASS not_null_geo_dim_geo_id ............................................ [[32mPASS[0m in 0.14s]
[0m12:41:56.201931 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:41:56.198077 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:41:56.204345 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:41:56.202396 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:41:56.203480 [info ] [Thread-3 (]: 3 of 9 PASS not_null_product_dim_prod_id ....................................... [[32mPASS[0m in 0.15s]
[0m12:41:56.206234 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:41:56.204916 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m12:41:56.207687 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:56.200368 [info ] [Thread-1 (]: 6 of 9 START test unique_customer_dim_cust_id .................................. [RUN]
[0m12:41:56.209424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m12:41:56.210007 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:41:56.206697 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:41:56.205473 [info ] [Thread-2 (]: 7 of 9 START test unique_geo_dim_geo_id ........................................ [RUN]
[0m12:41:56.218274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m12:41:56.218790 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:41:56.229130 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:41:56.217567 [info ] [Thread-3 (]: 8 of 9 START test unique_product_dim_prod_id ................................... [RUN]
[0m12:41:56.230993 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m12:41:56.231456 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:41:56.225096 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:41:56.230276 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m12:41:56.238544 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:41:56.239088 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_test"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_test"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:41:56.236933 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:41:56.237970 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:41:56.235885 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:41:56.247926 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:41:56.247229 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:41:56.257043 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m12:41:56.243696 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:41:56.251323 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:41:56.259205 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:41:56.260130 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m12:41:56.246386 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:41:56.261364 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:41:56.261827 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m12:41:56.262207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:56.262823 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m12:41:56.263627 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:41:56.264079 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m12:41:56.264488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:56.260737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:41:56.266554 [info ] [Thread-4 (]: 5 of 9 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ....... [[32mPASS[0m in 0.10s]
[0m12:41:56.270979 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:41:56.281918 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:41:56.282454 [info ] [Thread-4 (]: 9 of 9 START test unique_shipping_dim_ship_id .................................. [RUN]
[0m12:41:56.287147 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m12:41:56.288482 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:41:56.297267 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:41:56.299719 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:41:56.298420 [debug] [Thread-2 (]: SQL status: BEGIN in 0.034 seconds
[0m12:41:56.303797 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:41:56.297771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:41:56.304786 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:41:56.305188 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:41:56.304279 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:41:56.303204 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:41:56.306966 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:41:56.298950 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m12:41:56.308941 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:41:56.310120 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:41:56.310789 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:41:56.309666 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:41:56.308296 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m12:41:56.314233 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:56.312232 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m12:41:56.313712 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m12:41:56.315042 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m12:41:56.316417 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:41:56.324367 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m12:41:56.320242 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m12:41:56.318436 [info ] [Thread-1 (]: 6 of 9 PASS unique_customer_dim_cust_id ........................................ [[32mPASS[0m in 0.11s]
[0m12:41:56.327399 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:41:56.331441 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m12:41:56.332213 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:41:56.326573 [info ] [Thread-2 (]: 7 of 9 PASS unique_geo_dim_geo_id .............................................. [[32mPASS[0m in 0.11s]
[0m12:41:56.328662 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m12:41:56.332744 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:41:56.333419 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:41:56.334831 [info ] [Thread-3 (]: 8 of 9 PASS unique_product_dim_prod_id ......................................... [[32mPASS[0m in 0.10s]
[0m12:41:56.336185 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:41:56.339797 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:41:56.341814 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m12:41:56.342811 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m12:41:56.350424 [info ] [Thread-4 (]: 9 of 9 PASS unique_shipping_dim_ship_id ........................................ [[32mPASS[0m in 0.06s]
[0m12:41:56.351840 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:41:56.355427 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.355983 [debug] [MainThread]: On master: BEGIN
[0m12:41:56.357984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:56.373317 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:41:56.373963 [debug] [MainThread]: On master: COMMIT
[0m12:41:56.374412 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:56.374831 [debug] [MainThread]: On master: COMMIT
[0m12:41:56.375497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:41:56.375980 [debug] [MainThread]: On master: Close
[0m12:41:56.376509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:56.376985 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m12:41:56.377335 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721' was properly closed.
[0m12:41:56.379222 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m12:41:56.379660 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m12:41:56.380080 [info ] [MainThread]: 
[0m12:41:56.380532 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m12:41:56.382800 [debug] [MainThread]: Command end result
[0m12:41:56.403832 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:41:56.405540 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:41:56.412831 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:41:56.413302 [info ] [MainThread]: 
[0m12:41:56.414047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:56.414643 [info ] [MainThread]: 
[0m12:41:56.415216 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m12:41:56.416342 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5995383, "process_in_blocks": "0", "process_kernel_time": 0.185924, "process_mem_max_rss": "125144", "process_out_blocks": "3008", "process_user_time": 2.419981}
[0m12:41:56.421849 [debug] [MainThread]: Command `dbt test` succeeded at 12:41:56.421660 after 1.61 seconds
[0m12:41:56.422377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c937ad810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c92fe6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c93691750>]}
[0m12:41:56.425026 [debug] [MainThread]: Flushing usage events
[0m12:41:57.056129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:24.299458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af999d57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af9898c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af9898c190>]}


============================== 12:51:24.302735 | 1ce91ec6-2066-4de6-bdab-9fff4580ff2f ==============================
[0m12:51:24.302735 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:51:24.303671 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'debug': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'profiles_dir': '/home/dev/.dbt', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False'}
[0m12:51:24.487125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af9b4c7580>]}
[0m12:51:24.547873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af9898fe80>]}
[0m12:51:24.548712 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:51:24.659959 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:51:24.790140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:24.790585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:24.842301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af96f48fa0>]}
[0m12:51:24.854241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af97bf6cb0>]}
[0m12:51:24.854855 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m12:51:24.855260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af988e4a90>]}
[0m12:51:24.857226 [info ] [MainThread]: 
[0m12:51:24.857720 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:24.858090 [info ] [MainThread]: 
[0m12:51:24.858665 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:24.863211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m12:51:24.881827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m12:51:24.978344 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:51:24.978845 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:51:24.979771 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m12:51:24.979376 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m12:51:24.980643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:24.980105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:24.989069 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:51:24.989607 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m12:51:24.989995 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m12:51:24.990523 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:51:24.990928 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m12:51:24.991757 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m12:51:24.993787 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m12:51:24.995187 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m12:51:24.995837 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:51:24.996319 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m12:51:24.997519 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m12:51:25.001052 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m12:51:25.006794 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:25.007763 [debug] [MainThread]: On master: BEGIN
[0m12:51:25.008158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:25.016085 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:51:25.016570 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:25.016990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:51:25.020113 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m12:51:25.022053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce91ec6-2066-4de6-bdab-9fff4580ff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af96fe1de0>]}
[0m12:51:25.022646 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:25.023345 [debug] [MainThread]: On master: Close
[0m12:51:25.026822 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m12:51:25.027423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now model.superstore_dwh.calendar_dim)
[0m12:51:25.027898 [debug] [Thread-2 (]: Began running node model.superstore_dwh.stg_orders
[0m12:51:25.028393 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m12:51:25.028911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.superstore_dwh.stg_orders)
[0m12:51:25.035822 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m12:51:25.036312 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.stg_orders
[0m12:51:25.044997 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m12:51:25.046168 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m12:51:25.048878 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m12:51:25.051282 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.stg_orders
[0m12:51:25.053234 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.stg_orders
[0m12:51:25.055667 [debug] [Thread-4 (]: Began running node model.superstore_dwh.customer_dim
[0m12:51:25.056312 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.customer_dim'
[0m12:51:25.056788 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.customer_dim
[0m12:51:25.060890 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m12:51:25.061455 [debug] [Thread-3 (]: Began running node model.superstore_dwh.geo_dim
[0m12:51:25.064489 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_dwh.geo_dim'
[0m12:51:25.065089 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.geo_dim
[0m12:51:25.063764 [debug] [Thread-1 (]: Began running node model.superstore_dwh.product_dim
[0m12:51:25.069768 [debug] [Thread-2 (]: Began running node model.superstore_dwh.shipping_dim
[0m12:51:25.070455 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.customer_dim
[0m12:51:25.071608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.shipping_dim)
[0m12:51:25.072647 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.customer_dim
[0m12:51:25.073180 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m12:51:25.070985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.product_dim)
[0m12:51:25.069248 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m12:51:25.076293 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m12:51:25.080841 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.shipping_dim
[0m12:51:25.078002 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.geo_dim
[0m12:51:25.082569 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.geo_dim
[0m12:51:25.077033 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.product_dim
[0m12:51:25.081718 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.shipping_dim
[0m12:51:25.080025 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:51:25.090737 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.customer_dim, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m12:51:25.091219 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:51:25.083091 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:51:25.098534 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.geo_dim, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m12:51:25.089752 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m12:51:25.097830 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:51:25.107917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.shipping_dim, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m12:51:25.108430 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:51:25.099023 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:51:25.107347 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.product_dim
[0m12:51:25.120215 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.product_dim
[0m12:51:25.120738 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:51:25.121269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.product_dim, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m12:51:25.106554 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m12:51:25.112697 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m12:51:25.119167 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m12:51:25.124192 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:51:25.125036 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m12:51:25.122644 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:51:25.123414 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:51:25.127253 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m12:51:25.127746 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:51:25.121722 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:51:25.126479 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m12:51:25.133284 [debug] [Thread-4 (]: Began running node model.superstore_dwh.sales_fact
[0m12:51:25.133881 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now model.superstore_dwh.sales_fact)
[0m12:51:25.134308 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.sales_fact
[0m12:51:25.128507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m12:51:25.139095 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:51:25.125606 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:51:25.143689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721, now test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d)
[0m12:51:25.144164 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:51:25.132480 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m12:51:25.138457 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m12:51:25.151246 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.sales_fact
[0m12:51:25.152133 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.sales_fact
[0m12:51:25.143027 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m12:51:25.155725 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:51:25.150510 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:51:25.160345 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m12:51:25.160912 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:51:25.161375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m12:51:25.149564 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m12:51:25.156821 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m12:51:25.164275 [debug] [Thread-2 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:51:25.164823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m12:51:25.165247 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:51:25.154788 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:51:25.171969 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.sales_fact, now test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688)
[0m12:51:25.172604 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:51:25.163685 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:51:25.162925 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:51:25.180129 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m12:51:25.194879 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m12:51:25.184158 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m12:51:25.195867 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:51:25.196846 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m12:51:25.198425 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m12:51:25.199951 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:51:25.200758 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:51:25.204434 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m12:51:25.203438 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m12:51:25.207904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:25.208365 [debug] [MainThread]: Connection 'test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279' was properly closed.
[0m12:51:25.208763 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m12:51:25.209145 [debug] [MainThread]: Connection 'test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688' was properly closed.
[0m12:51:25.209483 [debug] [MainThread]: Connection 'test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d' was properly closed.
[0m12:51:25.225976 [debug] [MainThread]: Command end result
[0m12:51:25.362256 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:51:25.364070 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:51:25.371665 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m12:51:25.373432 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:51:25.373898 [info ] [MainThread]: Building catalog
[0m12:51:25.388592 [debug] [ThreadPool]: Acquiring new postgres connection 'superstore.information_schema'
[0m12:51:25.409186 [debug] [ThreadPool]: Using postgres connection "superstore.information_schema"
[0m12:51:25.410375 [debug] [ThreadPool]: On superstore.information_schema: BEGIN
[0m12:51:25.411119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:25.422153 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:51:25.422764 [debug] [ThreadPool]: Using postgres connection "superstore.information_schema"
[0m12:51:25.423236 [debug] [ThreadPool]: On superstore.information_schema: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "superstore.information_schema"} */

    
    

    select
        'superstore' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('geo_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('sales_fact')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('calendar_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('product_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('shipping_dim')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('customer_dim')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:51:25.444967 [debug] [ThreadPool]: SQL status: SELECT 76 in 0.021 seconds
[0m12:51:25.451366 [debug] [ThreadPool]: On superstore.information_schema: ROLLBACK
[0m12:51:25.452313 [debug] [ThreadPool]: On superstore.information_schema: Close
[0m12:51:25.468418 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/dev/Downloads/pde_magistr/superstore_dwh/target/catalog.json
[0m12:51:25.489282 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m12:51:25.491012 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m12:51:25.491435 [info ] [MainThread]: Catalog written to /home/dev/Downloads/pde_magistr/superstore_dwh/target/catalog.json
[0m12:51:25.492851 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2517753, "process_in_blocks": "0", "process_kernel_time": 0.166924, "process_mem_max_rss": "118036", "process_out_blocks": "5504", "process_user_time": 1.996182}
[0m12:51:25.493434 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:51:25.493332 after 1.25 seconds
[0m12:51:25.493875 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:51:25.494225 [debug] [MainThread]: Connection 'superstore.information_schema' was properly closed.
[0m12:51:25.494642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af999d57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af9920d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af97bf6b30>]}
[0m12:51:25.495110 [debug] [MainThread]: Flushing usage events
[0m12:51:26.214104 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:53.287296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ee0b97e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ed070d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ed070d00>]}


============================== 12:51:53.289808 | 98cff362-6b89-4a48-a3b9-9f031270849c ==============================
[0m12:51:53.289808 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:51:53.290428 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'quiet': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/home/dev/.dbt', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'empty': 'None'}
[0m12:51:53.451376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98cff362-6b89-4a48-a3b9-9f031270849c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ed01b1c0>]}
[0m12:51:53.515527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98cff362-6b89-4a48-a3b9-9f031270849c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ed073dc0>]}
[0m13:40:00.528492 [error] [MainThread]: Encountered an error:

[0m13:40:00.565890 [error] [MainThread]: Traceback (most recent call last):
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m13:40:00.568691 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 2887.339, "process_in_blocks": "96", "process_kernel_time": 0.24042, "process_mem_max_rss": "102596", "process_out_blocks": "3368", "process_user_time": 1.830724}
[0m13:40:00.569336 [debug] [MainThread]: Command `dbt docs serve` failed at 13:40:00.569230 after 2887.34 seconds
[0m13:40:00.569852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ee0b97e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ec100640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7116ec1003a0>]}
[0m13:40:00.570290 [debug] [MainThread]: Flushing usage events
[0m13:40:01.279249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:37.195269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643edb57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643dd70220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643dd701c0>]}


============================== 14:55:37.236074 | 84f03881-bae1-4fd4-91cc-bc87c08c4cd7 ==============================
[0m14:55:37.236074 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:55:37.236881 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'empty': 'None', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'version_check': 'True', 'target_path': 'None', 'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/dev/.dbt'}
[0m14:55:37.665331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84f03881-bae1-4fd4-91cc-bc87c08c4cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643dd12f80>]}
[0m14:55:37.731740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84f03881-bae1-4fd4-91cc-bc87c08c4cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643dd73e80>]}
[0m14:55:37.733023 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:55:37.951011 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:55:38.150545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:38.151059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:38.205281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84f03881-bae1-4fd4-91cc-bc87c08c4cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c528fd0>]}
[0m14:55:38.313018 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m14:55:38.324222 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m14:55:38.465271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84f03881-bae1-4fd4-91cc-bc87c08c4cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c528fd0>]}
[0m14:55:38.465966 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m14:55:38.466464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84f03881-bae1-4fd4-91cc-bc87c08c4cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c529930>]}
[0m14:55:38.468572 [info ] [MainThread]: 
[0m14:55:38.469050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:38.469424 [info ] [MainThread]: 
[0m14:55:38.470086 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:38.475495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m14:55:38.492259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m14:55:38.612756 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m14:55:38.613295 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m14:55:38.613752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:38.614360 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m14:55:38.614861 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m14:55:38.615241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:38.757726 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m14:55:38.758531 [debug] [ThreadPool]: SQL status: BEGIN in 0.143 seconds
[0m14:55:38.759232 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m14:55:38.759977 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m14:55:38.760758 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m14:55:38.761584 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m14:55:39.000843 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.238 seconds
[0m14:55:39.001396 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.239 seconds
[0m14:55:39.002815 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m14:55:39.004141 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m14:55:39.004989 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m14:55:39.005627 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m14:55:39.013730 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.014258 [debug] [MainThread]: On master: BEGIN
[0m14:55:39.014709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:39.022609 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:55:39.023132 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.023590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:55:39.127068 [debug] [MainThread]: SQL status: SELECT 3 in 0.103 seconds
[0m14:55:39.136377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84f03881-bae1-4fd4-91cc-bc87c08c4cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6440869fc0>]}
[0m14:55:39.139833 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:39.142120 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.143241 [debug] [MainThread]: On master: BEGIN
[0m14:55:39.145903 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:55:39.146787 [debug] [MainThread]: On master: COMMIT
[0m14:55:39.147777 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.148578 [debug] [MainThread]: On master: COMMIT
[0m14:55:39.150043 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:55:39.150952 [debug] [MainThread]: On master: Close
[0m14:55:39.177702 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m14:55:39.178334 [info ] [Thread-1 (]: 1 of 9 START test not_null_customer_dim_cust_id ................................ [RUN]
[0m14:55:39.179057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m14:55:39.179726 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m14:55:39.180277 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m14:55:39.180807 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m14:55:39.191809 [info ] [Thread-3 (]: 3 of 9 START test not_null_product_dim_prod_id ................................. [RUN]
[0m14:55:39.192605 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688'
[0m14:55:39.193049 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m14:55:39.182158 [info ] [Thread-2 (]: 2 of 9 START test not_null_geo_dim_geo_id ...................................... [RUN]
[0m14:55:39.181501 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m14:55:39.217780 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m14:55:39.221814 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m14:55:39.218405 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m14:55:39.220536 [info ] [Thread-4 (]: 4 of 9 START test not_null_shipping_dim_ship_id ................................ [RUN]
[0m14:55:39.219866 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m14:55:39.241758 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m14:55:39.242752 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m14:55:39.246403 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m14:55:39.244976 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d'
[0m14:55:39.260252 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m14:55:39.259116 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m14:55:39.273456 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m14:55:39.262265 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m14:55:39.277409 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m14:55:39.278089 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m14:55:39.280277 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m14:55:39.283202 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m14:55:39.280840 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m14:55:39.282544 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m14:55:39.281744 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m14:55:39.290466 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m14:55:39.287151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:39.289742 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m14:55:39.291542 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:55:39.286186 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m14:55:39.290890 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:39.292873 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m14:55:39.296950 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m14:55:39.297652 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:55:39.304108 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m14:55:39.304777 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m14:55:39.305653 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_test"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:39.312909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m14:55:39.313460 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m14:55:39.313930 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_test"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:39.318880 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m14:55:39.319519 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m14:55:39.320005 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_test"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:39.320637 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m14:55:39.321104 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m14:55:39.321678 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_test"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m14:55:39.346942 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.026 seconds
[0m14:55:39.352240 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m14:55:39.353938 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m14:55:39.353043 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.035 seconds
[0m14:55:39.358747 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m14:55:39.359610 [info ] [Thread-4 (]: 4 of 9 PASS not_null_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.11s]
[0m14:55:39.360639 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m14:55:39.361152 [debug] [Thread-4 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m14:55:39.361713 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m14:55:39.362325 [info ] [Thread-4 (]: 5 of 9 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ . [RUN]
[0m14:55:39.372526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m14:55:39.376162 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.069 seconds
[0m14:55:39.381775 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m14:55:39.365791 [info ] [Thread-1 (]: 1 of 9 PASS not_null_customer_dim_cust_id ...................................... [[32mPASS[0m in 0.19s]
[0m14:55:39.379901 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m14:55:39.366562 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.039 seconds
[0m14:55:39.382613 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m14:55:39.405791 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m14:55:39.401959 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m14:55:39.403516 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m14:55:39.383555 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m14:55:39.410780 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m14:55:39.406325 [info ] [Thread-1 (]: 6 of 9 START test unique_customer_dim_cust_id .................................. [RUN]
[0m14:55:39.417355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m14:55:39.410126 [info ] [Thread-3 (]: 3 of 9 PASS not_null_product_dim_prod_id ....................................... [[32mPASS[0m in 0.22s]
[0m14:55:39.418797 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m14:55:39.416699 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m14:55:39.420065 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m14:55:39.421144 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m14:55:39.428266 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m14:55:39.426191 [info ] [Thread-2 (]: 2 of 9 PASS not_null_geo_dim_geo_id ............................................ [[32mPASS[0m in 0.21s]
[0m14:55:39.449275 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m14:55:39.450518 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m14:55:39.451583 [info ] [Thread-2 (]: 8 of 9 START test unique_product_dim_prod_id ................................... [RUN]
[0m14:55:39.452224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m14:55:39.447027 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m14:55:39.439817 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m14:55:39.448522 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m14:55:39.455744 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m14:55:39.454085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:39.452755 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m14:55:39.454729 [info ] [Thread-3 (]: 7 of 9 START test unique_geo_dim_geo_id ........................................ [RUN]
[0m14:55:39.470686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m14:55:39.463491 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m14:55:39.473173 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m14:55:39.479303 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m14:55:39.480798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:39.478738 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m14:55:39.485493 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m14:55:39.471336 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m14:55:39.493607 [debug] [Thread-4 (]: SQL status: BEGIN in 0.040 seconds
[0m14:55:39.495697 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m14:55:39.514219 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m14:55:39.510565 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m14:55:39.513051 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m14:55:39.512358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m14:55:39.517766 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m14:55:39.517139 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_test"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_test"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:55:39.518542 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m14:55:39.515553 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m14:55:39.526467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:39.524568 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m14:55:39.519129 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:39.528234 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m14:55:39.533128 [debug] [Thread-3 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m14:55:39.537062 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:39.537934 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:55:39.545072 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m14:55:39.548683 [debug] [Thread-1 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m14:55:39.554584 [info ] [Thread-1 (]: 6 of 9 PASS unique_customer_dim_cust_id ........................................ [[32mPASS[0m in 0.14s]
[0m14:55:39.566568 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m14:55:39.568008 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m14:55:39.562246 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m14:55:39.565809 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m14:55:39.571989 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m14:55:39.572690 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m14:55:39.570864 [info ] [Thread-1 (]: 9 of 9 START test unique_shipping_dim_ship_id .................................. [RUN]
[0m14:55:39.581055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m14:55:39.573763 [debug] [Thread-3 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:39.581684 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m14:55:39.579690 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:39.580504 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.061 seconds
[0m14:55:39.587857 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m14:55:39.602192 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m14:55:39.594312 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m14:55:39.598513 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:55:39.613184 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m14:55:39.593982 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m14:55:39.614421 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m14:55:39.615134 [debug] [Thread-4 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m14:55:39.611113 [debug] [Thread-3 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m14:55:39.619369 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m14:55:39.623715 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m14:55:39.623003 [debug] [Thread-2 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m14:55:39.632690 [debug] [Thread-3 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m14:55:39.624166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:39.630708 [info ] [Thread-2 (]: 8 of 9 PASS unique_product_dim_prod_id ......................................... [[32mPASS[0m in 0.18s]
[0m14:55:39.639090 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m14:55:39.622613 [info ] [Thread-4 (]: 5 of 9 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ....... [[32mPASS[0m in 0.25s]
[0m14:55:39.639994 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m14:55:39.635100 [info ] [Thread-3 (]: 7 of 9 PASS unique_geo_dim_geo_id .............................................. [[32mPASS[0m in 0.16s]
[0m14:55:39.653589 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m14:55:39.668621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m14:55:39.669298 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m14:55:39.672088 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:55:39.676195 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:55:39.681421 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m14:55:39.689685 [debug] [Thread-1 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m14:55:39.692376 [info ] [Thread-1 (]: 9 of 9 PASS unique_shipping_dim_ship_id ........................................ [[32mPASS[0m in 0.11s]
[0m14:55:39.696186 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m14:55:39.709334 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.712857 [debug] [MainThread]: On master: BEGIN
[0m14:55:39.716632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:39.734437 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m14:55:39.735727 [debug] [MainThread]: On master: COMMIT
[0m14:55:39.736639 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.737539 [debug] [MainThread]: On master: COMMIT
[0m14:55:39.738772 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:55:39.739775 [debug] [MainThread]: On master: Close
[0m14:55:39.740865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:39.742004 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m14:55:39.743007 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m14:55:39.744197 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m14:55:39.745323 [debug] [MainThread]: Connection 'test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279' was properly closed.
[0m14:55:39.746003 [info ] [MainThread]: 
[0m14:55:39.748120 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m14:55:39.753181 [debug] [MainThread]: Command end result
[0m14:55:39.813676 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m14:55:39.816044 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m14:55:39.848023 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m14:55:39.848704 [info ] [MainThread]: 
[0m14:55:39.850291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:39.851121 [info ] [MainThread]: 
[0m14:55:39.851906 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m14:55:39.862745 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.753559, "process_in_blocks": "62848", "process_kernel_time": 0.274145, "process_mem_max_rss": "119552", "process_out_blocks": "2112", "process_user_time": 2.316476}
[0m14:55:39.863413 [debug] [MainThread]: Command `dbt test` succeeded at 14:55:39.863301 after 2.76 seconds
[0m14:55:39.866696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643edb57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c951a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c950c70>]}
[0m14:55:39.867832 [debug] [MainThread]: Flushing usage events
[0m14:55:40.631381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:33.851762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78812afb57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788129f6c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788129f6c190>]}


============================== 15:03:33.854399 | 14f5e86e-52f8-477a-822e-91dd1bed2b8d ==============================
[0m15:03:33.854399 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:03:33.855088 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'empty': 'None', 'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_colors': 'True', 'printer_width': '80', 'profiles_dir': '/home/dev/.dbt', 'partial_parse': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False'}
[0m15:03:34.029296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f5e86e-52f8-477a-822e-91dd1bed2b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788129f170d0>]}
[0m15:03:34.091388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14f5e86e-52f8-477a-822e-91dd1bed2b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78812a0fc6d0>]}
[0m15:03:34.092277 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:03:34.190044 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:03:34.326567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:34.327076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:34.383502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14f5e86e-52f8-477a-822e-91dd1bed2b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788128328fd0>]}
[0m15:03:34.408776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14f5e86e-52f8-477a-822e-91dd1bed2b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788128fd6c50>]}
[0m15:03:34.409418 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m15:03:34.409900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f5e86e-52f8-477a-822e-91dd1bed2b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788128fd6b60>]}
[0m15:03:34.411964 [info ] [MainThread]: 
[0m15:03:34.412489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:03:34.412900 [info ] [MainThread]: 
[0m15:03:34.413601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:03:34.419347 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m15:03:34.434921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m15:03:34.520475 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m15:03:34.520986 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m15:03:34.521864 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m15:03:34.522214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:34.521438 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m15:03:34.522849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:34.530843 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:03:34.531617 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:03:34.532019 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m15:03:34.532625 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m15:03:34.533356 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m15:03:34.533924 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m15:03:34.537054 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m15:03:34.537693 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m15:03:34.539037 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m15:03:34.540402 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m15:03:34.541201 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m15:03:34.541720 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m15:03:34.549647 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:34.550820 [debug] [MainThread]: On master: BEGIN
[0m15:03:34.551244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:34.558676 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:03:34.559176 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:34.559733 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:03:34.563190 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m15:03:34.565398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f5e86e-52f8-477a-822e-91dd1bed2b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78812830e500>]}
[0m15:03:34.565993 [debug] [MainThread]: On master: ROLLBACK
[0m15:03:34.567756 [debug] [MainThread]: On master: Close
[0m15:03:34.573053 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m15:03:34.573657 [debug] [Thread-2 (]: Began running node model.superstore_dwh.stg_orders
[0m15:03:34.574296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now model.superstore_dwh.calendar_dim)
[0m15:03:34.574899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.superstore_dwh.stg_orders)
[0m15:03:34.575496 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m15:03:34.575997 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.stg_orders
[0m15:03:34.584649 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m15:03:34.586069 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m15:03:34.586904 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.stg_orders
[0m15:03:34.587883 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.stg_orders
[0m15:03:34.588551 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m15:03:34.589294 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m15:03:34.590139 [debug] [Thread-4 (]: Began running node model.superstore_dwh.customer_dim
[0m15:03:34.590719 [debug] [Thread-3 (]: Began running node model.superstore_dwh.geo_dim
[0m15:03:34.591192 [debug] [Thread-2 (]: Began running node model.superstore_dwh.product_dim
[0m15:03:34.593505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.product_dim)
[0m15:03:34.592345 [debug] [Thread-1 (]: Began running node model.superstore_dwh.shipping_dim
[0m15:03:34.594548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.shipping_dim)
[0m15:03:34.594982 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m15:03:34.593971 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.product_dim
[0m15:03:34.592995 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_dwh.geo_dim'
[0m15:03:34.591863 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.customer_dim'
[0m15:03:34.597766 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m15:03:34.600539 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m15:03:34.601182 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.geo_dim
[0m15:03:34.601720 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.customer_dim
[0m15:03:34.602594 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.product_dim
[0m15:03:34.603305 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.shipping_dim
[0m15:03:34.611207 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.shipping_dim
[0m15:03:34.610304 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.product_dim
[0m15:03:34.609327 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m15:03:34.606184 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m15:03:34.612149 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m15:03:34.612742 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m15:03:34.614058 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.customer_dim
[0m15:03:34.613534 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.geo_dim
[0m15:03:34.614672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.shipping_dim, now test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d)
[0m15:03:34.615240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.product_dim, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m15:03:34.616054 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.customer_dim
[0m15:03:34.616823 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.geo_dim
[0m15:03:34.617290 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m15:03:34.617767 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m15:03:34.618270 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m15:03:34.618777 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m15:03:34.630807 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m15:03:34.636506 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m15:03:34.637150 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.customer_dim, now test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688)
[0m15:03:34.637729 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.geo_dim, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m15:03:34.638596 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m15:03:34.641042 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m15:03:34.639735 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m15:03:34.640189 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m15:03:34.639261 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m15:03:34.641784 [debug] [Thread-2 (]: Began running node model.superstore_dwh.sales_fact
[0m15:03:34.645890 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m15:03:34.649686 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m15:03:34.650726 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m15:03:34.651429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7, now model.superstore_dwh.sales_fact)
[0m15:03:34.652352 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m15:03:34.652914 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.sales_fact
[0m15:03:34.654749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m15:03:34.660165 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m15:03:34.659573 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m15:03:34.655504 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m15:03:34.664122 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m15:03:34.664847 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m15:03:34.667932 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m15:03:34.665866 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m15:03:34.667128 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m15:03:34.666509 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.sales_fact
[0m15:03:34.669020 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m15:03:34.668462 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m15:03:34.669918 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m15:03:34.672303 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m15:03:34.671240 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m15:03:34.673734 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m15:03:34.670760 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.sales_fact
[0m15:03:34.673016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m15:03:34.671771 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m15:03:34.680255 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m15:03:34.679187 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m15:03:34.679847 [debug] [Thread-2 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m15:03:34.678538 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m15:03:34.684614 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m15:03:34.688833 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m15:03:34.689617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.sales_fact, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m15:03:34.690599 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m15:03:34.691090 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m15:03:34.693679 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m15:03:34.692891 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m15:03:34.692085 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m15:03:34.691571 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m15:03:34.694835 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m15:03:34.702584 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m15:03:34.703643 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m15:03:34.704438 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m15:03:34.705950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:34.706367 [debug] [MainThread]: Connection 'test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279' was properly closed.
[0m15:03:34.706815 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m15:03:34.707196 [debug] [MainThread]: Connection 'test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d' was properly closed.
[0m15:03:34.707632 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721' was properly closed.
[0m15:03:34.710341 [debug] [MainThread]: Command end result
[0m15:03:34.808760 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m15:03:34.811537 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m15:03:34.821945 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m15:03:34.842285 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m15:03:34.843072 [info ] [MainThread]: Building catalog
[0m15:03:34.853706 [debug] [ThreadPool]: Acquiring new postgres connection 'superstore.information_schema'
[0m15:03:34.860429 [debug] [ThreadPool]: Using postgres connection "superstore.information_schema"
[0m15:03:34.861054 [debug] [ThreadPool]: On superstore.information_schema: BEGIN
[0m15:03:34.861486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:34.871685 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:03:34.872242 [debug] [ThreadPool]: Using postgres connection "superstore.information_schema"
[0m15:03:34.872666 [debug] [ThreadPool]: On superstore.information_schema: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "superstore.information_schema"} */

    
    

    select
        'superstore' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('calendar_dim')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('sales_fact')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('geo_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('product_dim')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('shipping_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('customer_dim')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m15:03:35.002229 [debug] [ThreadPool]: SQL status: SELECT 76 in 0.129 seconds
[0m15:03:35.006581 [debug] [ThreadPool]: On superstore.information_schema: ROLLBACK
[0m15:03:35.007337 [debug] [ThreadPool]: On superstore.information_schema: Close
[0m15:03:35.024110 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/dev/Downloads/pde_magistr/superstore_dwh/target/catalog.json
[0m15:03:35.044769 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m15:03:35.047186 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m15:03:35.047721 [info ] [MainThread]: Catalog written to /home/dev/Downloads/pde_magistr/superstore_dwh/target/catalog.json
[0m15:03:35.048866 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2589076, "process_in_blocks": "3376", "process_kernel_time": 0.155745, "process_mem_max_rss": "117684", "process_out_blocks": "5504", "process_user_time": 2.081966}
[0m15:03:35.049504 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:03:35.049365 after 1.26 seconds
[0m15:03:35.049925 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:03:35.050282 [debug] [MainThread]: Connection 'superstore.information_schema' was properly closed.
[0m15:03:35.050732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78812afb57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788129e317e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78812a0fc6d0>]}
[0m15:03:35.051233 [debug] [MainThread]: Flushing usage events
[0m15:03:35.726451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:42.987703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eeb7b69720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eeb6af4220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eeb6af41c0>]}


============================== 15:03:42.990356 | 8c7e68c2-d830-4791-b23e-587e88add683 ==============================
[0m15:03:42.990356 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:03:42.991102 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'invocation_command': 'dbt docs serve', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/home/dev/.dbt', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m15:03:43.170197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c7e68c2-d830-4791-b23e-587e88add683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eeb64cd690>]}
[0m15:03:43.233057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c7e68c2-d830-4791-b23e-587e88add683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eeb6ac5450>]}
[0m15:06:12.361654 [error] [MainThread]: Encountered an error:

[0m15:06:12.401284 [error] [MainThread]: Traceback (most recent call last):
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m15:06:12.402579 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 149.47105, "process_in_blocks": "432", "process_kernel_time": 0.103938, "process_mem_max_rss": "102488", "process_out_blocks": "3360", "process_user_time": 1.483391}
[0m15:06:12.403174 [debug] [MainThread]: Command `dbt docs serve` failed at 15:06:12.403049 after 149.47 seconds
[0m15:06:12.403679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eeb7b69720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eeb5dbc580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eeb5dbc310>]}
[0m15:06:12.404490 [debug] [MainThread]: Flushing usage events
[0m15:06:13.150930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:44.063669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e627f45780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e626ed8220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e626ed81c0>]}


============================== 20:58:44.098911 | 1eddba55-27ad-4901-a1aa-e60469b5ab25 ==============================
[0m20:58:44.098911 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:58:44.099586 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'empty': 'None', 'debug': 'False', 'profiles_dir': '/home/dev/.dbt', 'invocation_command': 'dbt test', 'printer_width': '80', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'use_colors': 'True', 'static_parser': 'True', 'log_format': 'default', 'partial_parse': 'True', 'target_path': 'None'}
[0m20:58:44.505283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eddba55-27ad-4901-a1aa-e60469b5ab25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e626e82a10>]}
[0m20:58:44.566290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eddba55-27ad-4901-a1aa-e60469b5ab25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e626edbe20>]}
[0m20:58:44.567473 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:58:44.773974 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:58:44.976740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:58:44.977294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:58:45.035017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eddba55-27ad-4901-a1aa-e60469b5ab25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6255c8f70>]}
[0m20:58:45.147917 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m20:58:45.157450 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m20:58:45.275232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eddba55-27ad-4901-a1aa-e60469b5ab25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6259f2770>]}
[0m20:58:45.275915 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m20:58:45.276352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eddba55-27ad-4901-a1aa-e60469b5ab25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6259f2e90>]}
[0m20:58:45.278464 [info ] [MainThread]: 
[0m20:58:45.278951 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:45.279416 [info ] [MainThread]: 
[0m20:58:45.280104 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:58:45.288280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m20:58:45.297092 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m20:58:45.396031 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:58:45.396686 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m20:58:45.397507 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m20:58:45.397910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:45.397052 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m20:58:45.398678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:45.476873 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m20:58:45.477744 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:58:45.478364 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m20:58:45.478890 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m20:58:45.479624 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m20:58:45.480312 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m20:58:45.492777 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m20:58:45.494473 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m20:58:45.494973 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.015 seconds
[0m20:58:45.495386 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m20:58:45.496539 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m20:58:45.497387 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m20:58:45.504560 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:45.505142 [debug] [MainThread]: On master: BEGIN
[0m20:58:45.505540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:45.512655 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:58:45.513138 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:45.513987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:58:45.528011 [debug] [MainThread]: SQL status: SELECT 3 in 0.013 seconds
[0m20:58:45.529900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eddba55-27ad-4901-a1aa-e60469b5ab25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6299dd480>]}
[0m20:58:45.530428 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:45.531102 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:45.531576 [debug] [MainThread]: On master: BEGIN
[0m20:58:45.532549 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:58:45.532991 [debug] [MainThread]: On master: COMMIT
[0m20:58:45.533411 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:45.533806 [debug] [MainThread]: On master: COMMIT
[0m20:58:45.534485 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:58:45.534913 [debug] [MainThread]: On master: Close
[0m20:58:45.560254 [debug] [Thread-1 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m20:58:45.560827 [info ] [Thread-1 (]: 1 of 9 START test not_null_customer_dim_cust_id ................................ [RUN]
[0m20:58:45.561453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m20:58:45.561977 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m20:58:45.568035 [debug] [Thread-2 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m20:58:45.577792 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m20:58:45.577254 [info ] [Thread-2 (]: 2 of 9 START test not_null_geo_dim_geo_id ...................................... [RUN]
[0m20:58:45.591737 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m20:58:45.596609 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m20:58:45.599796 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m20:58:45.591131 [info ] [Thread-3 (]: 3 of 9 START test not_null_product_dim_prod_id ................................. [RUN]
[0m20:58:45.603157 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688'
[0m20:58:45.601877 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m20:58:45.602445 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m20:58:45.603624 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m20:58:45.600359 [info ] [Thread-4 (]: 4 of 9 START test not_null_shipping_dim_ship_id ................................ [RUN]
[0m20:58:45.621896 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m20:58:45.645455 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m20:58:45.641694 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m20:58:45.649130 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m20:58:45.640063 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m20:58:45.644038 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d'
[0m20:58:45.650307 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m20:58:45.652063 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m20:58:45.654240 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m20:58:45.661738 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m20:58:45.662183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:45.655519 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m20:58:45.660564 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m20:58:45.670376 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:45.659882 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m20:58:45.672199 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m20:58:45.674230 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m20:58:45.675233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m20:58:45.682379 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:58:45.680570 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m20:58:45.682919 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m20:58:45.688440 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m20:58:45.689492 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_test"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:45.691824 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m20:58:45.701030 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m20:58:45.697430 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m20:58:45.702747 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m20:58:45.701755 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_test"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:45.705688 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m20:58:45.709226 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m20:58:45.712032 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m20:58:45.713897 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:58:45.715413 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_test"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:45.729337 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m20:58:45.730916 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m20:58:45.731983 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_test"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:45.742235 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.042 seconds
[0m20:58:45.751117 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m20:58:45.753606 [debug] [Thread-1 (]: On test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m20:58:45.757251 [info ] [Thread-1 (]: 1 of 9 PASS not_null_customer_dim_cust_id ...................................... [[32mPASS[0m in 0.20s]
[0m20:58:45.759436 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m20:58:45.763122 [debug] [Thread-1 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m20:58:45.764018 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.031 seconds
[0m20:58:45.765461 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m20:58:45.763628 [info ] [Thread-1 (]: 5 of 9 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ . [RUN]
[0m20:58:45.769033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m20:58:45.772015 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m20:58:45.770765 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.060 seconds
[0m20:58:45.778780 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m20:58:45.771223 [debug] [Thread-4 (]: On test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m20:58:45.782428 [info ] [Thread-4 (]: 4 of 9 PASS not_null_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.14s]
[0m20:58:45.785943 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m20:58:45.795377 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m20:58:45.796247 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.079 seconds
[0m20:58:45.794533 [debug] [Thread-2 (]: On test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m20:58:45.795840 [info ] [Thread-4 (]: 6 of 9 START test unique_customer_dim_cust_id .................................. [RUN]
[0m20:58:45.807965 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m20:58:45.808466 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m20:58:45.797787 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m20:58:45.806110 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m20:58:45.815951 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m20:58:45.818680 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m20:58:45.819745 [debug] [Thread-3 (]: On test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m20:58:45.829762 [info ] [Thread-3 (]: 3 of 9 PASS not_null_product_dim_prod_id ....................................... [[32mPASS[0m in 0.23s]
[0m20:58:45.828847 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m20:58:45.815042 [info ] [Thread-2 (]: 2 of 9 PASS not_null_geo_dim_geo_id ............................................ [[32mPASS[0m in 0.22s]
[0m20:58:45.833094 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m20:58:45.827252 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m20:58:45.835473 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m20:58:45.835969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:45.834941 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m20:58:45.830480 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m20:58:45.843125 [debug] [Thread-3 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m20:58:45.834366 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m20:58:45.844714 [info ] [Thread-3 (]: 8 of 9 START test unique_product_dim_prod_id ................................... [RUN]
[0m20:58:45.848486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m20:58:45.851502 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m20:58:45.851030 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m20:58:45.859076 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m20:58:45.845275 [info ] [Thread-2 (]: 7 of 9 START test unique_geo_dim_geo_id ........................................ [RUN]
[0m20:58:45.867190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m20:58:45.867773 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m20:58:45.865652 [debug] [Thread-4 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m20:58:45.863002 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m20:58:45.865043 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m20:58:45.876053 [debug] [Thread-1 (]: Using postgres connection "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m20:58:45.876497 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_test"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_test"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:58:45.875243 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m20:58:45.874426 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:45.879555 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m20:58:45.887267 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m20:58:45.885702 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m20:58:45.894391 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m20:58:45.896491 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m20:58:45.896970 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:45.896001 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m20:58:45.900793 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m20:58:45.901322 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m20:58:45.901803 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:45.915356 [debug] [Thread-4 (]: SQL status: BEGIN in 0.041 seconds
[0m20:58:45.915952 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m20:58:45.916473 [debug] [Thread-4 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:45.921835 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:58:45.926439 [debug] [Thread-4 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m20:58:45.931077 [debug] [Thread-4 (]: On test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m20:58:45.928985 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.052 seconds
[0m20:58:45.938545 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m20:58:45.929848 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m20:58:45.930323 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m20:58:45.943554 [debug] [Thread-2 (]: Using postgres connection "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m20:58:45.944124 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:45.942955 [debug] [Thread-3 (]: Using postgres connection "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m20:58:45.935663 [info ] [Thread-4 (]: 6 of 9 PASS unique_customer_dim_cust_id ........................................ [[32mPASS[0m in 0.13s]
[0m20:58:45.948699 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m20:58:45.947179 [debug] [Thread-1 (]: On test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m20:58:45.949293 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m20:58:45.945907 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:45.954035 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m20:58:45.953235 [info ] [Thread-1 (]: 5 of 9 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ....... [[32mPASS[0m in 0.18s]
[0m20:58:45.971015 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m20:58:45.968899 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:58:45.959774 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m20:58:45.955062 [info ] [Thread-4 (]: 9 of 9 START test unique_shipping_dim_ship_id .................................. [RUN]
[0m20:58:45.975971 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m20:58:45.976434 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m20:58:45.975129 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m20:58:45.983426 [debug] [Thread-2 (]: On test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m20:58:45.990315 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m20:58:45.995946 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m20:58:45.994732 [debug] [Thread-3 (]: On test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m20:58:45.991543 [info ] [Thread-2 (]: 7 of 9 PASS unique_geo_dim_geo_id .............................................. [[32mPASS[0m in 0.12s]
[0m20:58:46.000933 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m20:58:46.002184 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m20:58:46.003048 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m20:58:46.005727 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m20:58:46.006293 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:46.004915 [info ] [Thread-3 (]: 8 of 9 PASS unique_product_dim_prod_id ......................................... [[32mPASS[0m in 0.16s]
[0m20:58:46.007622 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m20:58:46.017812 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m20:58:46.018371 [debug] [Thread-4 (]: Using postgres connection "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m20:58:46.018895 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "node_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_test"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:46.023440 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:58:46.025216 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m20:58:46.028846 [debug] [Thread-4 (]: On test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m20:58:46.032668 [info ] [Thread-4 (]: 9 of 9 PASS unique_shipping_dim_ship_id ........................................ [[32mPASS[0m in 0.06s]
[0m20:58:46.035780 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m20:58:46.040394 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:46.040922 [debug] [MainThread]: On master: BEGIN
[0m20:58:46.041307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:46.054183 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m20:58:46.055330 [debug] [MainThread]: On master: COMMIT
[0m20:58:46.056307 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:46.057266 [debug] [MainThread]: On master: COMMIT
[0m20:58:46.058434 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:58:46.059357 [debug] [MainThread]: On master: Close
[0m20:58:46.060623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:46.063031 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2' was properly closed.
[0m20:58:46.063956 [debug] [MainThread]: Connection 'test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279' was properly closed.
[0m20:58:46.064722 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m20:58:46.065536 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m20:58:46.066490 [info ] [MainThread]: 
[0m20:58:46.067473 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m20:58:46.071269 [debug] [MainThread]: Command end result
[0m20:58:46.121249 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m20:58:46.123764 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m20:58:46.139343 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m20:58:46.142137 [info ] [MainThread]: 
[0m20:58:46.143525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:46.144888 [info ] [MainThread]: 
[0m20:58:46.146072 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m20:58:46.147712 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.173161, "process_in_blocks": "58120", "process_kernel_time": 0.208858, "process_mem_max_rss": "119760", "process_out_blocks": "2112", "process_user_time": 2.309907}
[0m20:58:46.149985 [debug] [MainThread]: Command `dbt test` succeeded at 20:58:46.149863 after 2.18 seconds
[0m20:58:46.150906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e627f45780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e626e82a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6255246d0>]}
[0m20:58:46.151885 [debug] [MainThread]: Flushing usage events
[0m20:58:47.119951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:01:50.538945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bfebd7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bee74220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bee741c0>]}


============================== 21:01:50.541742 | 0b3c96f5-c80e-4e7c-9f7d-f930b1125e6c ==============================
[0m21:01:50.541742 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:01:50.542318 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'empty': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs generate', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'fail_fast': 'False', 'use_colors': 'True', 'printer_width': '80', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'profiles_dir': '/home/dev/.dbt', 'log_format': 'default', 'debug': 'False'}
[0m21:01:50.709364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b3c96f5-c80e-4e7c-9f7d-f930b1125e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bee1f820>]}
[0m21:01:50.770539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b3c96f5-c80e-4e7c-9f7d-f930b1125e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bf009120>]}
[0m21:01:50.771402 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:01:50.866029 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m21:01:50.994572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:50.995059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:51.048028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b3c96f5-c80e-4e7c-9f7d-f930b1125e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bd331000>]}
[0m21:01:51.073134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b3c96f5-c80e-4e7c-9f7d-f930b1125e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bdfdece0>]}
[0m21:01:51.073780 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m21:01:51.074203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b3c96f5-c80e-4e7c-9f7d-f930b1125e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bee77eb0>]}
[0m21:01:51.076150 [info ] [MainThread]: 
[0m21:01:51.076673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:01:51.077059 [info ] [MainThread]: 
[0m21:01:51.077648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:01:51.082323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m21:01:51.097634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_test'
[0m21:01:51.196393 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m21:01:51.196881 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m21:01:51.197706 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m21:01:51.197296 [debug] [ThreadPool]: On list_superstore_dw_test: BEGIN
[0m21:01:51.198056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:51.198487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:51.208329 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:01:51.208946 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_test"
[0m21:01:51.209473 [debug] [ThreadPool]: On list_superstore_dw_test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_test"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_test'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_test'
  
[0m21:01:51.211546 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m21:01:51.212185 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m21:01:51.212626 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m21:01:51.214011 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m21:01:51.215384 [debug] [ThreadPool]: On list_superstore_dw_test: ROLLBACK
[0m21:01:51.215990 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:01:51.217228 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m21:01:51.217818 [debug] [ThreadPool]: On list_superstore_dw_test: Close
[0m21:01:51.219514 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m21:01:51.226906 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:51.227391 [debug] [MainThread]: On master: BEGIN
[0m21:01:51.227811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:01:51.235388 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:01:51.235930 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:51.236359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:01:51.239755 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m21:01:51.241639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b3c96f5-c80e-4e7c-9f7d-f930b1125e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bd3c8d30>]}
[0m21:01:51.242122 [debug] [MainThread]: On master: ROLLBACK
[0m21:01:51.242768 [debug] [MainThread]: On master: Close
[0m21:01:51.247195 [debug] [Thread-1 (]: Began running node model.superstore_dwh.calendar_dim
[0m21:01:51.247773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.superstore_dwh.calendar_dim)
[0m21:01:51.248250 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.calendar_dim
[0m21:01:51.254636 [debug] [Thread-2 (]: Began running node model.superstore_dwh.stg_orders
[0m21:01:51.255312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_superstore_dw_test, now model.superstore_dwh.stg_orders)
[0m21:01:51.255738 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.stg_orders
[0m21:01:51.256670 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.calendar_dim"
[0m21:01:51.259648 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.stg_orders"
[0m21:01:51.260627 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.stg_orders
[0m21:01:51.261411 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.stg_orders
[0m21:01:51.262247 [debug] [Thread-4 (]: Began running node model.superstore_dwh.customer_dim
[0m21:01:51.263988 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_dwh.customer_dim'
[0m21:01:51.263389 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.calendar_dim
[0m21:01:51.265214 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.calendar_dim
[0m21:01:51.264411 [debug] [Thread-4 (]: Began compiling node model.superstore_dwh.customer_dim
[0m21:01:51.262777 [debug] [Thread-3 (]: Began running node model.superstore_dwh.geo_dim
[0m21:01:51.269632 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_dwh.geo_dim'
[0m21:01:51.268448 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_dwh.customer_dim"
[0m21:01:51.268982 [debug] [Thread-2 (]: Began running node model.superstore_dwh.shipping_dim
[0m21:01:51.265701 [debug] [Thread-1 (]: Began running node model.superstore_dwh.product_dim
[0m21:01:51.270093 [debug] [Thread-3 (]: Began compiling node model.superstore_dwh.geo_dim
[0m21:01:51.271349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.calendar_dim, now model.superstore_dwh.product_dim)
[0m21:01:51.275518 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.product_dim
[0m21:01:51.274483 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_dwh.geo_dim"
[0m21:01:51.274966 [debug] [Thread-4 (]: Began executing node model.superstore_dwh.customer_dim
[0m21:01:51.270867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.stg_orders, now model.superstore_dwh.shipping_dim)
[0m21:01:51.278364 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.product_dim"
[0m21:01:51.279413 [debug] [Thread-4 (]: Finished running node model.superstore_dwh.customer_dim
[0m21:01:51.280008 [debug] [Thread-3 (]: Began executing node model.superstore_dwh.geo_dim
[0m21:01:51.281553 [debug] [Thread-3 (]: Finished running node model.superstore_dwh.geo_dim
[0m21:01:51.280514 [debug] [Thread-2 (]: Began compiling node model.superstore_dwh.shipping_dim
[0m21:01:51.282385 [debug] [Thread-4 (]: Began running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m21:01:51.283018 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.product_dim
[0m21:01:51.287673 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.product_dim
[0m21:01:51.283444 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m21:01:51.286839 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.customer_dim, now test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m21:01:51.286260 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_dwh.shipping_dim"
[0m21:01:51.288191 [debug] [Thread-1 (]: Began running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m21:01:51.288807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.geo_dim, now test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m21:01:51.291037 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m21:01:51.289311 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m21:01:51.290461 [debug] [Thread-2 (]: Began executing node model.superstore_dwh.shipping_dim
[0m21:01:51.289907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.product_dim, now test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m21:01:51.302727 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m21:01:51.306517 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m21:01:51.307489 [debug] [Thread-2 (]: Finished running node model.superstore_dwh.shipping_dim
[0m21:01:51.308019 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m21:01:51.309540 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m21:01:51.316728 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m21:01:51.317196 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m21:01:51.315775 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m21:01:51.310048 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m21:01:51.308840 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m21:01:51.317753 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688)
[0m21:01:51.318421 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m21:01:51.319183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.shipping_dim, now test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m21:01:51.319971 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m21:01:51.320446 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m21:01:51.321173 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721
[0m21:01:51.321667 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m21:01:51.322133 [debug] [Thread-4 (]: Began running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m21:01:51.325822 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m21:01:51.326507 [debug] [Thread-1 (]: Began running node model.superstore_dwh.sales_fact
[0m21:01:51.329956 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m21:01:51.330756 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m21:01:51.331372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721, now model.superstore_dwh.sales_fact)
[0m21:01:51.332166 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m21:01:51.332733 [debug] [Thread-4 (]: Began compiling node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m21:01:51.333241 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m21:01:51.333727 [debug] [Thread-1 (]: Began compiling node model.superstore_dwh.sales_fact
[0m21:01:51.334509 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688
[0m21:01:51.338410 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m21:01:51.339468 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m21:01:51.344422 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_dwh.sales_fact"
[0m21:01:51.345103 [debug] [Thread-3 (]: Began running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m21:01:51.345772 [debug] [Thread-2 (]: Began running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m21:01:51.346394 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688, now test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d)
[0m21:01:51.347087 [debug] [Thread-1 (]: Began executing node model.superstore_dwh.sales_fact
[0m21:01:51.347578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2, now test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m21:01:51.350128 [debug] [Thread-2 (]: Began compiling node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m21:01:51.349696 [debug] [Thread-1 (]: Finished running node model.superstore_dwh.sales_fact
[0m21:01:51.348867 [debug] [Thread-3 (]: Began compiling node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m21:01:51.348172 [debug] [Thread-4 (]: Began executing node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m21:01:51.353769 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m21:01:51.359194 [debug] [Thread-4 (]: Finished running node test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m21:01:51.358084 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m21:01:51.361522 [debug] [Thread-3 (]: Began executing node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m21:01:51.360684 [debug] [Thread-2 (]: Began executing node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m21:01:51.360018 [debug] [Thread-1 (]: Began running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m21:01:51.362805 [debug] [Thread-3 (]: Finished running node test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m21:01:51.363632 [debug] [Thread-2 (]: Finished running node test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m21:01:51.364335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_dwh.sales_fact, now test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m21:01:51.365171 [debug] [Thread-1 (]: Began compiling node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m21:01:51.372295 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m21:01:51.373105 [debug] [Thread-1 (]: Began executing node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m21:01:51.373944 [debug] [Thread-1 (]: Finished running node test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m21:01:51.375018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:51.375387 [debug] [MainThread]: Connection 'test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279' was properly closed.
[0m21:01:51.375799 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m21:01:51.376179 [debug] [MainThread]: Connection 'test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c' was properly closed.
[0m21:01:51.376541 [debug] [MainThread]: Connection 'test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d' was properly closed.
[0m21:01:51.379258 [debug] [MainThread]: Command end result
[0m21:01:51.473395 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m21:01:51.475182 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m21:01:51.482758 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/superstore_dwh/target/run_results.json
[0m21:01:51.506298 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m21:01:51.507256 [info ] [MainThread]: Building catalog
[0m21:01:51.518847 [debug] [ThreadPool]: Acquiring new postgres connection 'superstore.information_schema'
[0m21:01:51.533797 [debug] [ThreadPool]: Using postgres connection "superstore.information_schema"
[0m21:01:51.535540 [debug] [ThreadPool]: On superstore.information_schema: BEGIN
[0m21:01:51.536450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:51.545975 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m21:01:51.546674 [debug] [ThreadPool]: Using postgres connection "superstore.information_schema"
[0m21:01:51.549698 [debug] [ThreadPool]: On superstore.information_schema: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "superstore_dwh", "target_name": "dev", "connection_name": "superstore.information_schema"} */

    
    

    select
        'superstore' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('calendar_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('geo_dim')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('shipping_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('product_dim')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('sales_fact')) or (upper(sch.nspname) = upper('dw_test') and
           upper(tbl.relname) = upper('customer_dim')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('orders')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m21:01:51.591526 [debug] [ThreadPool]: SQL status: SELECT 76 in 0.041 seconds
[0m21:01:51.595400 [debug] [ThreadPool]: On superstore.information_schema: ROLLBACK
[0m21:01:51.596357 [debug] [ThreadPool]: On superstore.information_schema: Close
[0m21:01:51.611666 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/dev/Downloads/pde_magistr/superstore_dwh/target/catalog.json
[0m21:01:51.632522 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/manifest.json
[0m21:01:51.634754 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/superstore_dwh/target/semantic_manifest.json
[0m21:01:51.635266 [info ] [MainThread]: Catalog written to /home/dev/Downloads/pde_magistr/superstore_dwh/target/catalog.json
[0m21:01:51.636314 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.1518506, "process_in_blocks": "3376", "process_kernel_time": 0.147784, "process_mem_max_rss": "117864", "process_out_blocks": "5496", "process_user_time": 1.978114}
[0m21:01:51.637058 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:01:51.636951 after 1.15 seconds
[0m21:01:51.637478 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:01:51.637892 [debug] [MainThread]: Connection 'superstore.information_schema' was properly closed.
[0m21:01:51.638320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bfebd7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424bee1f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424be34cf10>]}
[0m21:01:51.638917 [debug] [MainThread]: Flushing usage events
[0m21:01:52.324360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:39.197123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773963eb17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773962e60220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773962e601c0>]}


============================== 21:02:39.199745 | 6df16c2d-ca6f-4d8b-b10b-a1ba44b940a9 ==============================
[0m21:02:39.199745 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:02:39.200312 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'empty': 'None', 'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/superstore_dwh/logs', 'write_json': 'True', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '/home/dev/.dbt', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False'}
[0m21:02:39.370149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6df16c2d-ca6f-4d8b-b10b-a1ba44b940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77396592b580>]}
[0m21:02:39.431043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6df16c2d-ca6f-4d8b-b10b-a1ba44b940a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773962d406a0>]}
[0m21:14:47.180653 [error] [MainThread]: Encountered an error:

[0m21:14:47.220757 [error] [MainThread]: Traceback (most recent call last):
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/home/dev/Downloads/pde_magistr/dbt-env/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m21:14:47.223460 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 728.08136, "process_in_blocks": "112", "process_kernel_time": 0.09795, "process_mem_max_rss": "102488", "process_out_blocks": "3360", "process_user_time": 1.485922}
[0m21:14:47.225048 [debug] [MainThread]: Command `dbt docs serve` failed at 21:14:47.224921 after 728.08 seconds
[0m21:14:47.225677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773963eb17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739623f47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739623f4340>]}
[0m21:14:47.226758 [debug] [MainThread]: Flushing usage events
[0m21:14:47.854984 [debug] [MainThread]: An error was encountered while trying to flush usage events
